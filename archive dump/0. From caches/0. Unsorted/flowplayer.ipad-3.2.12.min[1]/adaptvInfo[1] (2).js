(function(){window.adaptvInfo={POSITION:{ABOVE_VISIBLE_AREA:"aboveVisibleArea",BELOW_VISIBLE_AREA:"belowVisibleArea",LEFT_TO_VISIBLE_AREA:"leftToVisibleArea",RIGHT_TO_VISIBLE_AREA:"rightToVisibleArea",IN_VISIBLE_AREA:"inVisibleArea",HIDDEN:"hidden",UNKNOWN:"NA"},ADSAFE:{URL:"//pixel.adsafeprotected.com/bapi",AN_ID:6058},getElementInfo:function(a){var c=document[a]||window[a];var b=this.getElementInfoForElement(c);b.id=a;return b},getElementXY:function(d){var b=d,a=0,f=0,e=0;while(b&&!isNaN(b.offsetLeft)&&!isNaN(b.offsetTop)){if(window.getComputedStyle){e=window.getComputedStyle(b,null)}a+=b.offsetLeft-b.scrollLeft+(e?parseInt(e.getPropertyValue("border-left-width"),10):0);f+=b.offsetTop-b.scrollTop+(e?parseInt(e.getPropertyValue("border-top-width"),10):0);b=b.offsetParent}return{x:d.X=a,y:d.Y=f}},getElementStyle:function(a,b){if(a.currentStyle){return a.currentStyle[b]}else{if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(a,"")[b]}else{return a.style[b]}}},getElementInfoForElement:function(c){var b={leftOffset:0,topOffset:0,width:0,height:0};if(c){b.width=c.offsetWidth;b.height=c.offsetHeight;if(c.getBoundingClientRect){var a=c.getBoundingClientRect();b.leftOffset=Math.round(a.left);b.topOffset=Math.round(a.top)}else{var d=this.getElementXY(c);b.leftOffset=d.x;b.topOffset=d.y}}return b},isElementHidden:function(c){var a=false;var b=c;while(b){a=this.getElementStyle(c,"visibility")=="hidden"||this.getElementStyle(c,"display")=="none";if(a){break}b=b.offsetParent}return a},getBrowserInfo:function(){var c={searchString:function(g){for(var d=0;d<g.length;d++){var e=g[d].string;var f=g[d].prop;this.versionSearchString=g[d].versionSearch||g[d].identity;if(e){if(e.indexOf(g[d].subString)!=-1){return g[d].identity}}else{if(f){return g[d].identity}}}},searchVersion:function(e){var d=e.indexOf(this.versionSearchString);if(d==-1){return}return parseFloat(e.substring(d+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],toString:function(){return"AdapTV browser and os detector"}};var b=c.searchString(c.dataBrowser)||"An unknown browser";var a={browser:b};return a},getWindowInfo:function(c){var a={width:0,height:0,leftOffset:0,topOffset:0};if(typeof(c.innerWidth)!="undefined"){a.width=c.innerWidth;a.height=c.innerHeight}else{if(c.document.documentElement&&(c.document.documentElement.clientWidth||c.document.documentElement.clientHeight)){a.width=c.document.documentElement.clientWidth;a.height=c.document.documentElement.clientHeight}else{if(document.body.offsetWidth&&document.body.offsetHeight){a.width=c.document.body.offsetWidth;a.height=c.document.body.offsetHeight}}}var b=(document.compatMode&&document.compatMode!="BackCompat")?document.documentElement:document.body;a.leftOffset=document.all?b.scrollLeft:window.pageXOffset;a.topOffset=document.all?b.scrollTop:window.pageYOffset;return a},getElementPositionRelativeToVisiblearea:function(a,c){var b;if(c.width>0&&c.height>0&&a.width>0&&a.height>0){if(a.topOffset+a.height<=c.topOffset){b=this.POSITION.ABOVE_VISIBLE_AREA}else{if(a.topOffset>=c.height+c.topOffset){b=this.POSITION.BELOW_VISIBLE_AREA}else{if(a.leftOffset+a.width<=c.leftOffset){b=this.POSITION.LEFT_TO_VISIBLE_AREA}else{if(a.leftOffset>=c.width+c.leftOffset){b=this.POSITION.RIGHT_TO_VISIBLE_AREA}else{b=this.POSITION.IN_VISIBLE_AREA}}}}}else{b=this.POSITION.HIDDEN}return b},getVisibleFrameRect:function(b,a){var c={leftOffset:0,topOffset:0,width:0,height:0};c.leftOffset=Math.max(b.leftOffset,a.leftOffset);c.topOffset=Math.max(b.topOffset,a.topOffset);c.width=Math.min(b.leftOffset+b.width,a.leftOffset+a.width)-c.leftOffset;c.height=Math.min(b.topOffset+b.height,a.topOffset+a.height)-c.topOffset;return c},getHorizontalPercentageVisibility:function(b,c){var a=0;a=(Math.min((c.width-b.leftOffset),(b.width+b.leftOffset))/b.width)*100;a=Math.round(Math.min(Math.max(0,a),100)*100)/100;a=Math.round(a);return a},getVerticalPercentageVisibility:function(b,c){var a=0;a=(Math.min((c.height-b.topOffset),(b.height+b.topOffset))/b.height)*100;a=Math.round(Math.min(Math.max(0,a),100)*100)/100;a=Math.round(a);return a},getPlacementInfo:function(c,e,f){var b={position:this.POSITION.UNKNOWN,hVisibility:0,vVisibility:0};if(this.isElementHidden(c)){b.position=this.POSITION.HIDDEN}if(b.position!=this.POSITION.HIDDEN){var d={leftOffset:0,topOffset:0,width:f.width,height:f.height};var a=this.getElementPositionRelativeToVisiblearea(e,d);b.position=a;if(a==this.POSITION.IN_VISIBLE_AREA){b.hVisibility=this.getHorizontalPercentageVisibility(e,d);b.vVisibility=this.getVerticalPercentageVisibility(e,d)}if(b.hVisibility==0||b.vVisibility==0){b.hVisibility=0;b.vVisibility=0}}return b},getPlacementInfoWhenEmbeddedInIFrames:function(h,d,f,p){var c={position:this.POSITION.UNKNOWN,hVisibility:0,vVisibility:0};if(this.isElementHidden(h)){c.position=this.POSITION.HIDDEN}if(c.position!=this.POSITION.HIDDEN){var o=f[f.length-1];var l={leftOffset:0,topOffset:0,width:p.width,height:p.height};var k=this.getElementPositionRelativeToVisiblearea(o,l);c.position=k;if(k==this.POSITION.IN_VISIBLE_AREA){var b=this.getVisibleFrameRect(o,l);var e=f.length-1;var g=k;while(e>0){var n=f[e-1];var m=b;n.leftOffset+=m.leftOffset;n.topOffset+=m.topOffset;g=this.getElementPositionRelativeToVisiblearea(n,m);if(g==this.POSITION.IN_VISIBLE_AREA){b=this.getVisibleFrameRect(n,m)}else{break}e--}if(g==this.POSITION.IN_VISIBLE_AREA){d.leftOffset+=b.leftOffset;d.topOffset+=b.topOffset;var i=this.getElementPositionRelativeToVisiblearea(d,b);if(i==this.POSITION.IN_VISIBLE_AREA){b=this.getVisibleFrameRect(d,b);var a=(b.width/d.width)*100;a=Math.round(a*100)/100;a=Math.round(a);c.hVisibility=a;a=(b.height/d.height)*100;a=Math.round(a*100)/100;a=Math.round(a);c.vVisibility=a}else{c.position=this.POSITION.HIDDEN}}else{c.position=this.POSITION.HIDDEN}}}return c},getAdPlayerPositionInfo:function(f){var l={hostname:window.location.hostname,pageUrl:window.location.href,referrer:document.referrer,inIFrame:false,iframe:{parentUrl:"",topUrl:"",leftOffset:0,topOffset:0,width:0,height:0,crossDomain:false,levels:0},win:{width:0,height:0,leftOffset:0,topOffset:0},el:{leftOffset:0,topOffset:0,width:0,height:0,position:this.POSITION.UNKNOWN,hVisibility:0,vVisibility:0},browser:"NA"};l.browser=this.getBrowserInfo().browser;var b=this.getElementInfoForElement(f);l.el.leftOffset=b.leftOffset;l.el.topOffset=b.topOffset;l.el.width=b.width;l.el.height=b.height;if(this.isElementHidden(f)){l.el.position=this.POSITION.HIDDEN}l.win=this.getWindowInfo(window);var a=this.getPlacementInfo(f,l.el,l.win);if(a.position!=this.POSITION.IN_VISIBLE_AREA){l.el.position=a.position;l.el.hVisibility=a.hVisibility;l.el.vVisibility=a.vVisibility;l.el.width=l.el.width<l.win.width?l.el.width:l.win.width;l.el.height=l.el.height<l.win.height?l.el.height:l.win.height;return l}try{var o=window;var c=window.location;var n;try{n=window.top.location.href;if(typeof n===undefined){throw new Error("WebKit browser based adplayer is in an IFrame!")}else{if(n!==l.pageUrl){l.inIFrame=true;l.iframe.topUrl=n}}}catch(m){l.inIFrame=true;l.iframe.crossDomain=true}if(l.inIFrame&&n){if(window.parent&&window.parent.location){l.iframe.parentUrl=window.parent.location.href}l.win=this.getWindowInfo(window.top);var g=new Array();while(o.parent&&o.parent.document&&o.frames&&o!=window.top){var j=o.parent.document.getElementsByTagName("iframe");for(var h=0;h<j.length;h++){if(j[h].src&&j[h].src==c.href){var d=this.getElementInfoForElement(j[h]);if(h==0){l.iframe.width=d.width;l.iframe.height=d.height}l.iframe.leftOffset=d.leftOffset;l.iframe.topOffset=d.topOffset;g[l.iframe.levels]=d;l.iframe.levels+=1;c=o.parent.location;break}}o=o.parent}var a=this.getPlacementInfoWhenEmbeddedInIFrames(f,l.el,g,l.win);l.el.position=a.position;l.el.hVisibility=a.hVisibility;l.el.vVisibility=a.vVisibility}}catch(k){l.iframe.levels=-1}if(!l.inIFrame){var a=this.getPlacementInfo(f,l.el,l.win);l.el.position=a.position;l.el.hVisibility=a.hVisibility;l.el.vVisibility=a.vVisibility}return l},getPageVisibility:function(){if(typeof(document.visibilityState)!="undefined"){return document.visibilityState}else{var c=["webkit","moz","o","ms"];var a;for(var b=0;b<c.length;b++){a=c[b]+"VisibilityState";if(typeof(document[a])!="undefined"){return document[a]}}}return"NA"},getPlayerElement:function(d,h){var b;if(h&&document[h]&&document[h][d]){b=document[h]}else{if(h&&window[h]&&window[h][d]){b=window[h]}else{var k=document.getElementsByTagName("object");var a=document.getElementsByTagName("embed");var n=[];for(var g=0,c=k.length;g<c;n.push(k[g++])){}var f=[];for(var g=0,c=a.length;g<c;f.push(a[g++])){}var j=n.concat(f);for(var g=0;g<j.length;g++){try{if(j[g][d]()){b=j[g];break}}catch(m){}}}}return b},getAdaptvAdPlayerInfo:function(a,c){var b=this.getPlayerElement(c,a);if(b){var d=this.getAdPlayerPositionInfo(b);d.pageVisibility=this.getPageVisibility();return d}},injectJavascript:function(b){var a=document.createElement("script");var c=document.head||document.getElementsByTagName("head")[0]||document.documentElement;a.type="text/javascript";a.src=b;if(c!==null){c.appendChild(a)}},fraudScoreCallback:function(c,a){var b=this.getPlayerElement(c,null);b.__adaptv__fraudscore(a)},loadAdsafeJS:function(a,c,d){var e="adaptv"+new Date().getTime();window[e]=function(){adaptvInfo.fraudScoreCallback.apply(adaptvInfo,[c,arguments[0]]);window[e]=undefined};var b=this.ADSAFE.URL+"?anid="+this.ADSAFE.AN_ID+"&ias_callback="+e+"&pubid="+window.location.hostname+"&placementId="+d;this.injectJavascript(b)},AdPlayerNode:function(e){this.htmlNode=adaptvInfo.getPlayerElement(e,null);this.pointsPerEdge=1;this.minPtsViewable=3;var b=adaptvInfo.getElementInfoForElement(this.htmlNode);var g=b.topOffset;var f=b.leftOffset;var d=b.width;var a=b.height;var c=d/(this.pointsPerEdge+1);var h=a/(this.pointsPerEdge+1);this.getTopPoints=function(){var l=[];var j=f;for(var k=0;k<this.pointsPerEdge;k++){j+=c;l.push({x:j,y:g})}return l};this.getRightPoints=function(){var k=[];var l=g;for(var j=0;j<this.pointsPerEdge;j++){l+=h;k.push({x:(f+d)-1,y:l})}return k};this.getBottomPoints=function(){var l=[];var j=f;for(var k=0;k<this.pointsPerEdge;k++){j+=c;l.push({x:j,y:(g+a)-1})}return l};this.getLeftPoints=function(){var k=[];var l=g;for(var j=0;j<this.pointsPerEdge;j++){l+=h;k.push({x:f,y:l})}return k};this.getAllPoints=function(){return[this.getTopPoints(),this.getRightPoints(),this.getBottomPoints(),this.getLeftPoints()]};this.getAllPointsFlattened=function(){var o=[];var m=this.getAllPoints();for(var n=0;n<m.length;n++){var k=m[n];for(var l=0;l<k.length;l++){o.push(k[l])}}return o}},SPOT:{ID:1,GET_NEXT_ID:function(){return this.ID++}},Spot:function(){var e="/redir/client/FPSDetector.swf";var b="//redir.adap.tv";var f="//adaptv-a.akamaihd.net";var d=document.location.protocol=="https:";var a=(d)?f:b;var c=a+e;this.viewable=-1;this.id=adaptvInfo.SPOT.GET_NEXT_ID();this.interval=0;this.callbackFn;this.placementContext;this.inject=function(m,l,j,o){var n="adaptvSpotDiv_"+this.id;var g="adaptvVWSpot_"+this.id;if(document.getElementById(n)){return}this.placementContext=j;this.callbackFn=o;var p='<object width="1px" height="1px" id="{spotId}" name="{spotId}" align="center">';p+='<param name="movie" value="{url}" />';p+='<param name="bgcolor" value="#000000"/>';p+='<param name="allowScriptAccess" value="always" />';p+='<param name="FlashVars" value="autoStart=true"/>';p+='<embed src="{url}" width="1px" height="1px" id="{spotId}" name="{spotId}" align="center" bgcolor="#000000" allowScriptAccess="always" FlashVars = "autoStart=true" type="application/x-shockwave-flash"/>';p+="</object>";p=p.split("{url}").join(c);p=p.split("{spotId}").join(g);var i=document.body||document.getElementsByTagName("body")[0]||document.documentElement;var h=document.createElement("div");h.id=n;h.style.left=m+"px";h.style.top=l+"px";h.style.height="1px";h.style.width="1px";h.style.position="absolute";h.innerHTML=p;i.appendChild(h);var k=this;this.interval=setInterval(function(){if(window.__adaptv__&&window.__adaptv__.jsproxy&&window.__adaptv__.jsproxy[g]){__adaptv__.jsproxy[g]["fpsdetector"].__on("FPSDetected",k.listener,k);clearInterval(k.interval)}},100)};this.listener=function(g){this.viewable=parseInt(g.data,10);if(this.callbackFn){this.callbackFn.apply(this.placementContext);this.callbackFn=null}};this.destroy=function(){var i=document.body||document.getElementsByTagName("body")[0]||document.documentElement;var h="adaptvSpotDiv_"+this.id;var g=document.getElementById(h);i.removeChild(g)}},Placement:function(a){this.id=a;this.playerNode=new adaptvInfo.AdPlayerNode(a);this.spotsInjected=false;this.viewable=-1;this.spots=[];this.spotsState=[];this.timeout;this.timeout_ms=3000;this.callbackFnName="";this.getInfo=function(g){if(!this.spotsInjected){this.callbackFnName=g;var f=this.playerNode.getAllPointsFlattened();for(var c=0;c<f.length;c++){var b=f[c];var d=new adaptvInfo.Spot();d.inject(b.x,b.y,this,this.spotCallback);this.spots.push(d);this.spotsState.push(-1)}var e=this;this.timeout=setTimeout(function(){clearTimeout(e.timeout);if(!e.allSpotsReady()&&e.callbackFnName!=""){e.playerNode.htmlNode[e.callbackFnName](e.getMergedInfo())}},this.timeout_ms);this.spotsInjected=true;return null}return this.getMergedInfo()};this.spotCallback=function(){if(this.allSpotsReady()){clearTimeout(this.timeout);if(this.callbackFnName!=""){var b=this.getMergedInfo();this.playerNode.htmlNode[this.callbackFnName](b)}}};this.getMergedInfo=function(){var e=adaptvInfo.getVWInfo(this.playerNode.htmlNode);if(this.allSpotsReady()){var b=0;for(var c=0;c<this.spots.length;c++){var d=this.spots[c];b+=d.viewable;this.spotsState[c]=d.viewable}this.viewable=(b>=this.playerNode.minPtsViewable)?1:0}else{this.viewable=-1}e.viewableNew=this.viewable;if(e.active===0&&e.viewableNew===1){e.viewableNew=0}e.spotsState=this.spotsState.join();return e};this.allSpotsReady=function(){var c=0;for(var b=0;b<this.spots.length;b++){if(this.spots[b].viewable>-1){c++}}return(c==this.spots.length)};this.dispose=function(){var c=this.spots.length;for(var b=0;b<c;b++){this.spots[b].destroy()}this.playerNode=null;this.spotsInjected=false;this.viewable=-1;this.spots=[];this.spotsState=[];this.timeout=0;this.timeout_ms=3000;this.callbackFnName="";this.id=""}},placements:[],getInfo:function(e,a,g,f){var b={viewable:-1,viewableNew:-1,domId:"",active:0,spotsState:""};var j=this.getPlayerElement(a,e);if(f=="mindjoltinc"){b=adaptvInfo.getVWInfo(j);b.viewableNew=-1;b.spotsState="-1,-1,-1,-1";return b}var h=window.adaptvInfo.placements;var c;for(var d=0;d<h.length;++d){if(h[d].id===a){c=h[d];break}}if(c==undefined){c=new window.adaptvInfo.Placement(a);h.push(c)}return c.getInfo(g)},removePlacement:function(c){var a=window.adaptvInfo.placements;for(var b=0;b<a.length;b++){if(a[b].id===c){a[b].dispose();a.splice(b,1);break}}},getVWInfo:function(k){var b={viewable:-1,domId:"",active:0};var j={ACTIVE:1,INACTIVE:0};if(k){var d=window.adaptvInfo.getAdPlayerPositionInfo(k);b.pWidth=d.el.width;b.pHeight=d.el.height;b.domId=k.id;if(d.el.position!=window.adaptvInfo.POSITION.UNKNOWN){var g=(d.el.width*d.el.hVisibility)/100;var a=(d.el.height*d.el.vVisibility)/100;if(g==0||a==0){b.viewable=0}else{var c=(g*a)/(d.el.width*d.el.height);b.viewable=(c>=0.5)?1:0}}else{if(d.inIFrame){b.errinfo="inIframe"}if(d.iframe.crossDomain){b.errinfo="iframeCrossDomain"}}var h=false;var f=["webkit","moz","ms","o"];if(document.visibilityState){h=document.visibilityState!="visible"}else{for(var e=0;e<f.length;e++){if(document[f[e]+"VisibilityState"]){h=document[f[e]+"VisibilityState"]!="visible";break}}}b.active=(!h)?j.ACTIVE:j.INACTIVE}return b}}})();