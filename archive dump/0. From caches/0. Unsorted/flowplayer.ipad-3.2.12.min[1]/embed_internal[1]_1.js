Msn=window.Msn||{};Msn.Video=window.Msn.Video||new function(){};Msn.Video.WidgetServer=window.Msn.Video.WidgetServer||"img.widgets.video.s-msn.com";Msn.Video.SslWidgetServer=window.Msn.Video.SslWidgetServer||"img-widgets-video.msn.com";Msn.Video.LocationServiceHost=window.Msn.Video.LocationServiceHost||"video.msn.com";Msn.Video.SslLocationServiceHost=window.Msn.Video.SslLocationServiceHost||"hubs-video.msn.com";Msn.Video.V5AssetHost=window.Msn.Video.V5AssetHost||"img1.video.s-msn.com";Msn.Video.SslV5AssetHost=window.Msn.Video.SslV5AssetHost||"imgs1-video.msn.com";Msn.Video.Widgets={playerarticle:{current:{path:"fl/player/current/player.swf"}},player:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"fl/player/current/player.swf"}},playerrtl:{current:{path:"flash/soapbox1_1RTL.swf",oldRoot:true}},playerad:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"fl/player/current/player.swf"}},slplayer:{current:{path:"sl/player/current/player.xap"},silverlight:true},slplayerad:{current:{path:"sl/player/current/player.xap"},silverlight:true},gallery:{"2":{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true},current:{path:"fl/gallerywidget/current/gallerywidget.swf"}},galleryrtl:{current:{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true}},customplayer:{"2":{path:"flash/customplayer/1_0/customplayer.swf",oldRoot:true},current:{path:"fl/customplayer/current/customPlayer.swf"}}};Msn.Video.initializeVersionTable=function(){var c=Msn.Video.JavascriptApi.getQSPs();if(checkString(c.versiontable)){var b=c.versiontable.split(";");for(var d in b){var a=b[d].split(":");if(a.length==2)Msn.Video.VersionTable[a[0].toLowerCase()]=a[1]}}};function checkDefined(a){return typeof a!="undefined"&&null!=a}function checkString(a){return typeof a=="string"&&a.length>0}function checkObject(a){return typeof a=="object"&&null!=a}function checkArray(c,b){var a=c instanceof Array;if(b!="")a=a&&c.length>=b;return a}function checkFunction(a){return typeof a=="function"}function checkInt(a,c,b){if(null!=a&&(typeof a!="string"||""!=a)&&!isNaN(a)){if(checkDefined(c)&&a<c)return false;if(checkDefined(b)&&a>b)return false;return true}return false}function parseBool(a){return typeof a!="undefined"&&null!=a&&a.toLowerCase()=="true"}function padLeft(d,c,b){var a="";while(a.length<c)a=a+b;return a+d}function format(b){for(var a=1;a<arguments.length;a++)b=b.split("{"+(a-1)+"}").join(arguments[a]);return b}function openStandardWindow(b,a){return openWindow(b,a,1024,768,"resizable=yes,toolbar=yes,menubar=yes,scrollbars=yes,status=yes,location=yes")}function openWindow(c,b,e,d,a){window.open(c,b,format("width={0},height={1}{2}",e,d,a?","+a:""))}Msn.Video.Plugins=window.Msn.Video.Plugins||new function(){var a,c,b;function f(b){var a=-1;try{a=b.GetVariable("$version")}catch(c){}return a}function d(b){var a=b.split(",");return {raw:b,major:parseInt(a[0].split(" ")[1],10),minor:parseInt(a[1],10),revision:parseInt(a[2],10),revisionStr:a[2]}}function e(b){var a=b.split(" ");return {raw:b,major:parseInt(a[2].split(".")[0]),minor:parseInt(a[2].split(".")[1])}}this.hasFlash=function(m){var h="application/x-shockwave-flash";if(undefined==a){a=0;var g=null,i=window.navigator.plugins,b="Shockwave Flash",l=window.ActiveXObject,c;if(i&&i.length){g=i[b]||i[b+" 2.0"];var k=window.navigator.mimeTypes;if(g&&g.description&&(!k||k[h]&&k[h].enabledPlugin)){c=e(g.description);a=c.major+.1*c.minor}}else if(l){b=b.replace(" ","")+".";for(var j=15;j>2;--j)try{g=new l(b+b+j);c=d(f(g));a=c.major+.1*c.minor;break}catch(n){}}}return a>=m};this.hasSilverlight=function(l){if(undefined==c){var h=window,a,j=["5.0","4.0","3.0","2.0"],i="application/x-silverlight-2",b=0;try{var m=h.navigator,e=m.plugins;if(e&&e.length){a=e["Silverlight Plug-In"];if(a)b=/^\d+\.\d+/.exec(a.description)[0];a=0}else if(h.ActiveXObject){var k=new ActiveXObject("AgControl.AgControl");if(k){b=1;var d=document.createElement("OBJECT");d.codeType=i;if(typeof d.IsVersionSupported!="undefined")for(var f,g=0;f=j[g];++g)if(d.IsVersionSupported(f)){b=f;break}d=0}}}catch(n){}c=b}return c>=l};this.hasHtml5=function(){var c="video/mp4";if(undefined==b){var a=document.createElement("video")||false;try{b=a&&checkFunction(a.canPlayType)&&(a.canPlayType(c)=="maybe"||a.canPlayType(c)=="probably")}catch(d){b=false}a=null}return b}};Msn.Video.ua=window.navigator.userAgent.toLowerCase();Msn.Video.isChrome=Msn.Video.ua.match(/Chrome/i);Msn.Video.chromeVersion=/chrome[\/\s](\d+\.\d+)/.test(Msn.Video.ua)?new Number(RegExp.$1):0;Msn.Video.isSafari=/webkit/.test(Msn.Video.ua)&&!Msn.Video.isChrome;Msn.Video.safariVersion=/version\/(\d+\.\d+)(.\d+)*\s.*safari/.test(Msn.Video.ua)?new Number(RegExp.$1):0;Msn.Video.isFirefox=Msn.Video.ua.match(/Firefox/i);Msn.Video.firefoxVersion=/firefox[\/\s](\d+\.\d+)/.test(Msn.Video.ua)?new Number(RegExp.$1):0;Msn.Video.isIE=Msn.Video.ua.match(/MSIE \d+\.?/i);Msn.Video.IEVersion=/msie (\d+\.\d+)/.test(Msn.Video.ua)?new Number(RegExp.$1):0;Msn.Video.maybeIETmx=Msn.Video.isIE&&!(Msn.Video.Plugins.hasFlash(10)||Msn.Video.Plugins.hasSilverlight(4));Msn.Video.isIETmx=Msn.Video.isIE&&Msn.Video.IEVersion>=10;Msn.Video.isWindowsPhone=Msn.Video.ua.match(/windows phone/i)||Msn.Video.ua.match(/zunewp7/i);Msn.Video.isIPad=Msn.Video.ua.match(/iPad/i);Msn.Video.isIProduct=Msn.Video.ua.match(/iPhone/i)||Msn.Video.ua.match(/iPod/i)||Msn.Video.isIPad;Msn.Video.isPluginsUnsupported=Msn.Video.maybeIETmx||Msn.Video.isWindowsPhone||Msn.Video.isIProduct||(Msn.Video.ua.match(/Android/i)||Msn.Video.ua.match(/Silk/i)||Msn.Video.ua.match(/BlackBerry/i));function normalizeRootUrl(a){if(a){if(a.indexOf("http://")!=0)a="http://"+a;if(a.lastIndexOf("/")==a.length-1)a=a.substring(0,a.length-1)}return a}Msn.Video.EVENT_FLASH_DETECT="flash_detect";Msn.Video.FlashObject=function(F,H,C,B,E){var f="menu",e="base",g="bgColor",d="wmode",p="$1",o="application/x-shockwave-flash",c=null,j=this,I=j,r=F,w=H,b=E||{},i,a=c,t=c,z=0,A=0,x=0,k=0,l=0,s=0,n=c,q=window.navigator.plugins,y="Shockwave Flash";if(q&&q.length){n=q[y]||q[y+" 2.0"];var u=window.navigator.mimeTypes;if(n&&n.description&&(!u||u[o]&&u[o].enabledPlugin)){var m=n.description.replace(/^.*\s+(\S+\s+\S+$)/,p);k=parseInt(m.replace(/^(.*)\..*$/,p),10);l=parseInt(m.replace(/^.*\.(.*)\s.*$/,p),10);s=/[a-zA-Z]/.test(m)?parseInt(m.replace(/^.*[a-zA-Z]+(.*)$/,p),10):0}}else if(window.ActiveXObject)try{var v=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(v){var h=v.GetVariable("$version");if(h){h=h.split(" ")[1].split(",");k=parseInt(h[0],10);l=parseInt(h[1],10);s=parseInt(h[2],10)}}v=c}catch(G){}if(b[d]==undefined)b[d]="transparent";if(b[g]==undefined)b[g]="#000000";if(b[e]==undefined)b[e]=".";if(b[f]==undefined)b[f]="false";j.getObjectNode=function(){return a};j.setInstallCtrl=function(d,b,c,a){if(d!=undefined)t=d;z=b!=undefined?b:0;A=c!=undefined?c:0;x=a!=undefined?a:0};j.onDispose=function(){if(c!=a){if(Msn.Video.isIE)try{for(var b in a)if(checkFunction(a[b]))a[b]=c}catch(d){}if(i){if(checkFunction(i.removeChild))i.removeChild(a);i=c}if(a.parentNode)a.parentNode.removeChild(a);a=c}};j.render=function(j){var k="flashvars",h='">';i=j;i.innerHTML="";if(c!=j&&checkString(w))if(!D(z,A,x)&&t)t.render(j);else if(Msn.Video.isIE){j.innerHTML='<object id="'+r+'" '+'name="'+r+'" '+'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '+'height="'+B+'" '+'width="'+C+'"> '+'<param name="movie" value="'+w+h+'<param name="flashvars" value="'+b[k]+'"/> '+'<param name="menu" value="'+b[f]+h+'<param name="wmode" value="'+b[d]+h+'<param name="bgcolor" value="'+b[g]+h+'<param name="play" value="0">'+'<param name="quality" value="high">'+'<param name="allowScriptAccess" value="always">'+'<param name="allowFullScreen" value="true">'+'<param name="base" value="'+b[e]+h+"</object>";a=j.childNodes[0]}else{a=document.createElement("EMBED");a.id=r;a.setAttribute("name",r);a.setAttribute("type",o);a.setAttribute("width",C);a.setAttribute("height",B);a.setAttribute("src",w);a.setAttribute("flashVars",b[k]);a.setAttribute(f,b[f]);a.setAttribute(d,b[d]);a.setAttribute("bgcolor",b[g]);a.setAttribute("quality","high");a.setAttribute("allowScriptAccess","always");a.setAttribute("allowFullScreen","true");a.setAttribute(e,b[e]);j.appendChild(a)}else a=c};function D(a,b,c){return k>a||k==a&&(l>b||l==b&&s>=c)}};Msn.Video.FlashInstall=function(c){var a=this,b=c;this.cfg={REQUIRE_FLASH:"Please install the latest version of the free Adobe Flash Player. ",REQUIRE_FLASH_LINK:"Download now.",HELP_FLASH:"For help with Flash, see Adobe's ",HELP_FLASH_LINK:"Flash Player Support page.",FLASH_INSTALL_URL:"http://g.msn.com/0VD0/34/67?CM=not_auto_flash",FLASH_HELP_URL:"http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15511"};this.render=function(g){if(null!=g)if(checkDefined(b))g.appendChild(b);else{var f=document.createElement("DIV");f.className="flashInstallParent";g.appendChild(f);var c=document.createElement("DIV");c.className="flashInstall";c.style.backgroundColor="#e0e0e0";c.style.color="#666";c.style.fontFamily="Tahoma";c.style.fontSize="8pt";c.style.fontWeight="bold";c.style.padding="30px";f.appendChild(c);var e=document.createElement("span");e.innerHTML=a.cfg.REQUIRE_FLASH;c.appendChild(e);var d=document.createElement("a");d.setAttribute("href",a.cfg.FLASH_INSTALL_URL);d.setAttribute("target","_blank");d.innerHTML=a.cfg.REQUIRE_FLASH_LINK;d.style.color="#07519a";c.appendChild(d);c.appendChild(document.createElement("BR"));c.appendChild(document.createElement("BR"));e=document.createElement("span");e.innerHTML=a.cfg.HELP_FLASH;c.appendChild(e);d=document.createElement("a");d.setAttribute("href",a.cfg.FLASH_HELP_URL);d.setAttribute("target","_blank");d.innerHTML=a.cfg.HELP_FLASH_LINK;d.style.color="#07519a";c.appendChild(d)}}};if(!window.Silverlight)window.Silverlight={};Silverlight._silverlightCount=0;Silverlight.__onSilverlightInstalledCalled=false;Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=";Silverlight.__installationEventFired=false;Silverlight.onGetSilverlight=null;Silverlight.onSilverlightInstalled=function(){window.location.reload(false)};Silverlight.isInstalled=function(d){var c=true,b=null;if(d==undefined)d=b;var a=false,o=b;try{var k=b,l=false;if(window.ActiveXObject)try{k=new ActiveXObject("AgControl.AgControl");if(d===b)a=c;else if(k.IsVersionSupported(d))a=c;k=b}catch(n){l=c}else l=c;if(l){var m=navigator.plugins["Silverlight Plug-In"];if(m)if(d===b)a=c;else{var j=m.description;if(j==="1.0.30226.2")j="2.0.30226.2";var e=j.split(".");while(e.length>3)e.pop();while(e.length<4)e.push(0);var g=d.split(".");while(g.length>4)g.pop();var f,i,h=0;do{f=parseInt(g[h]);i=parseInt(e[h]);h++}while(h<g.length&&f===i);if(f<=i&&!isNaN(f))a=c}}}catch(n){a=false}return a};Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(a){}if(Silverlight.isInstalled(null)&&!Silverlight.__onSilverlightInstalledCalled){Silverlight.onSilverlightInstalled();Silverlight.__onSilverlightInstalledCalled=true}else setTimeout(Silverlight.WaitForInstallCompletion,3e3)}};Silverlight.__startup=function(){navigator.plugins.refresh();Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null);if(!Silverlight.isBrowserRestartRequired){Silverlight.WaitForInstallCompletion();if(!Silverlight.__installationEventFired){Silverlight.onInstallRequired();Silverlight.__installationEventFired=true}}else if(window.navigator.mimeTypes){var b=navigator.mimeTypes["application/x-silverlight-2"],c=navigator.mimeTypes["application/x-silverlight-2-b2"],d=navigator.mimeTypes["application/x-silverlight-2-b1"],a=d;if(c)a=c;if(!b&&(d||c)){if(!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=true}}else if(b&&a)if(b.enabledPlugin&&a.enabledPlugin)if(b.enabledPlugin.description!=a.enabledPlugin.description)if(!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=true}}if(!Silverlight.disableAutoStartup)if(window.removeEventListener)window.removeEventListener("load",Silverlight.__startup,false);else window.detachEvent("onload",Silverlight.__startup)};if(!Silverlight.disableAutoStartup)if(window.addEventListener)window.addEventListener("load",Silverlight.__startup,false);else window.attachEvent("onload",Silverlight.__startup);Silverlight.createObject=function(n,f,e,l,m,h,k){var d={},a=l,c=m;d.version=a.version;a.source=n;d.alt=a.alt;if(h)a.initParams=h;if(a.isWindowless&&!a.windowless)a.windowless=a.isWindowless;if(a.framerate&&!a.maxFramerate)a.maxFramerate=a.framerate;if(e&&!a.id)a.id=e;delete a.ignoreBrowserVer;delete a.inplaceInstallPrompt;delete a.version;delete a.isWindowless;delete a.framerate;delete a.data;delete a.src;delete a.alt;if(Silverlight.isInstalled(d.version)){for(var b in c)if(c[b]){if(b=="onLoad"&&typeof c[b]=="function"&&c[b].length!=1){var i=c[b];c[b]=function(a){return i(document.getElementById(e),k,a)}}var g=Silverlight.__getHandlerName(c[b]);if(g!=null){a[b]=g;c[b]=null}else throw"typeof events."+b+" must be 'function' or 'string'"}slPluginHTML=Silverlight.buildHTML(a)}else if(Silverlight.isInstalled("3.0")||Silverlight.isInstalled("2.0")||Silverlight.isInstalled("1.0")){slPluginHTML=Silverlight.buildPromptHTML(d);var j=confirm("This page requires a more recent version of Silverlight. Would you like to install the latest version of Silverlight?");if(j)Silverlight.getSilverlight()}else slPluginHTML=Silverlight.buildPromptHTML(d);if(f)f.innerHTML=slPluginHTML;else return slPluginHTML};Silverlight.buildHTML=function(a){var b=[];b.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"');if(a.id!=null)b.push(' id="'+Silverlight.HtmlAttributeEncode(a.id)+'"');if(a.width!=null)b.push(' width="'+a.width+'"');if(a.height!=null)b.push(' height="'+a.height+'"');b.push(" >");delete a.id;delete a.width;delete a.height;for(var c in a)if(a[c])b.push('<param name="'+Silverlight.HtmlAttributeEncode(c)+'" value="'+Silverlight.HtmlAttributeEncode(a[c])+'" />');b.push("</object>");return b.join("")};Silverlight.createObjectEx=function(b){var a=b,c=Silverlight.createObject(a.source,a.parentElement,a.id,a.properties,a.events,a.initParams,a.context);if(a.parentElement==null)return c};Silverlight.buildPromptHTML=function(b){var a="",d=Silverlight.fwlinkRoot,c=b.version;if(b.alt)a=b.alt;else{if(!c)c="";a="<a href='javascript:Silverlight.getSilverlight(\"{1}\");' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";a=a.replace("{1}",c);a=a.replace("{2}",d+"108181")}return a};Silverlight.getSilverlight=function(e){if(Silverlight.onGetSilverlight)Silverlight.onGetSilverlight();var b="",a=String(e).split(".");if(a.length>1){var c=parseInt(a[0]);if(isNaN(c)||c<2)b="1.0";else b=a[0]+"."+a[1]}var d="";if(b.match(/^\d+\056\d+$/))d="&v="+b;Silverlight.followFWLink("114576"+d)};Silverlight.followFWLink=function(a){top.location=Silverlight.fwlinkRoot+String(a)};Silverlight.HtmlAttributeEncode=function(c){var a,b="";if(c==null)return null;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a>43&&a<58&&a!=47||a==95)b=b+String.fromCharCode(a);else b=b+"&#"+a+";"}return b};Silverlight.default_error_handler=function(g,b){var e="Position: ",c="     \n",f,d=b.ErrorType;f=b.ErrorCode;var a="\nSilverlight error message     \n";a+="ErrorCode: "+f+"\n";a+="ErrorType: "+d+"       \n";a+="Message: "+b.ErrorMessage+c;if(d=="ParserError"){a+="XamlFile: "+b.xamlFile+c;a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}else if(d=="RuntimeError"){if(b.lineNumber!=0){a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}a+="MethodName: "+b.methodName+c}alert(a)};Silverlight.__cleanup=function(){for(var a=Silverlight._silverlightCount-1;a>=0;a--)window["__slEvent"+a]=null;Silverlight._silverlightCount=0;if(window.removeEventListener)window.removeEventListener("unload",Silverlight.__cleanup,false);else window.detachEvent("onunload",Silverlight.__cleanup)};Silverlight.__getHandlerName=function(b){var c="onunload",a="";if(typeof b=="string")a=b;else if(typeof b=="function"){if(Silverlight._silverlightCount==0)if(window.addEventListener)window.addEventListener(c,Silverlight.__cleanup,false);else window.attachEvent(c,Silverlight.__cleanup);var d=Silverlight._silverlightCount++;a="__slEvent"+d;window[a]=b}else a=null;return a};Silverlight.onRequiredVersionAvailable=function(){};Silverlight.onRestartRequired=function(){};Silverlight.onUpgradeRequired=function(){};Silverlight.onInstallRequired=function(){};Silverlight.IsVersionAvailableOnError=function(e,a){var b=true,c=false;try{if(a.ErrorCode==8001&&!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==8002&&!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==5014||a.ErrorCode==2106){if(Silverlight.__verifySilverlight2UpgradeSuccess(a.getHost()))c=b}else c=b}catch(d){}return c};Silverlight.IsVersionAvailableOnLoad=function(b){var a=false;try{if(Silverlight.__verifySilverlight2UpgradeSuccess(b.getHost()))a=true}catch(c){}return a};Silverlight.__verifySilverlight2UpgradeSuccess=function(d){var c=false,b="2.0.31005",a=null;try{if(d.IsVersionSupported(b+".99")){a=Silverlight.onRequiredVersionAvailable;c=true}else if(d.IsVersionSupported(b+".0"))a=Silverlight.onRestartRequired;else a=Silverlight.onUpgradeRequired;if(a&&!Silverlight.__installationEventFired){a();Silverlight.__installationEventFired=true}}catch(e){}return c};Msn.VideoSL=window["Msn.VideoSL"]||{};Msn.VideoSL.Inline=function(a){var c=a+"_p",b=a+"_pobj";this.BuildPlayer=function(d,o,n,k,j){var h="windowless",g="background",e="true",i={ifs:e,playlistmin:"2"},a;for(a in d)i[a]=d[a];d=[];for(a in i)if(i[a])d.push(a+"="+i[a].replace(/,/g,"%2C"));d=d.join(",");var f={width:o||300,height:n||269,framerate:"30",version:"4.0.50401",enableHtmlAccess:e,enableGPUAcceleration:e};for(var l in j)f[l]=j[l];if(undefined==f[g])f[g]="black";if(undefined==f[h])f[h]="false";var m={source:k?k:"http://img.widgets.video.s-msn.com/fl/player/current/player.xap",parentElement:document.getElementById(c),id:b,properties:f,events:null,initParams:d,context:null};Silverlight.createObjectEx(m)}};Msn.Video.flashObjects=Msn.Video.flashObjects||{};Msn.Video.widgetObjects=Msn.Video.widgetObjects||{};Msn.Video.createWidget=function(f,h,j,i,b,c,e,d,g,a){Msn.Video.createWidget2({divId:f,src:h,w:j,h:i,flashvars:b,widgetId:c,params:e,version:d,root:g,downlevel:a})};Msn.Video.createWidget2=function(a){var e="playeroverlay";if(!checkObject(a))throw new Error("Argument Error: 'param' is missing or not an object");var b=document.getElementById(a.divId);if(!checkDefined(b))throw new Error("Argument Error: no 'divId' parameter specified");if(!checkDefined(a.src))throw new Error("Argument Error: no 'src' parameter specified");var c=a.src.toLowerCase();if(!checkDefined(Msn.Video.Widgets[c])&&c!=e)throw new Error("Argument Error: invalid 'src' parameter specified");if(checkDefined(Msn.Video.flashObjects[a.divId]))Msn.Video.destroyWidget(a.divId);var f=Msn.Video.getVersionedWidgetsPath(getInitParam(a.flashvars,"version","current"));if(checkString(f)){a.flashvars=a.flashvars||{};setIfNotSet(a.flashvars,"versionPath",f)}if(e!=c&&Msn.Video.isPluginsUnsupported)if(c.indexOf("gallery")<0){c="player";setParam(a.flashvars,"leadWithImage","true")}switch(c){case "":break;case "player":case "playerad":case "slplayer":case "slplayerad":var g=new Msn.Video.Player;g.create(a,b);if(a.widgetId)Msn.Video.widgetObjects[a.widgetId]=g;break;case "playerarticle":var h=new Msn.Video.ArticlePlayer;h.create(a,b);break;case e:var i=new Msn.Video.OverlayPlayer;i.create(a,b);break;case "gallery":var j=new Msn.Video.Gallery;j.create(a,b);break;default:var d=document.createElement("div");d.setAttribute("id",a.divId+"_content");b.appendChild(d);a.params=a.params||{};a.src=Msn.Video.getWidgetEmbedAsset(a);if(Msn.Video.Widgets[c]&&Msn.Video.Widgets[c].silverlight==true)Msn.Video.buildSLWidget(c,b,d,a,a.flashvars);else Msn.Video.buildFlashWidget(b,d,a,a.flashvars);d=null}b=null};Msn.Video.destroyWidget=function(g){var a=null,e=Msn.Video.flashObjects[g];delete Msn.Video.flashObjects[g];Msn.Video.flashObjects[g]=a;var c=e?e.id:a,b=e?e.flash:a;if(checkDefined(b)){if(checkFunction(b.onDispose))b.onDispose();b=a}var d=Msn.Video.widgetObjects[c];if(checkDefined(d)){if(checkFunction(d.destroy))d.destroy();delete Msn.Video.widgetObjects[c];Msn.Video.widgetObjects[c]=a;d=a}var f=document.getElementById(c);if(checkDefined(f)){f.parentNode.removeChild(f);f=a}};Msn.Video.spawnOverlay=function(a){if(!a)throw new Error("missing param 'param'");if(!checkDefined(a.url))throw new Error("invalid param, missing param.url member");var e=new String(a.url),c=Msn.Video.JavascriptApi.getQSPsFromUrl(e);c.url=e;var f=c.overlaytype||"overlayplayer";Msn.Video.JavascriptApi.fraudDetectPing(c,"embed_internal.js-spawnOverlay",f);if(Msn.Video.IEVersion>=7||Msn.Video.firefoxVersion>=3.5||Msn.Video.chromeVersion>=9||Msn.Video.safariVersion>=4)Msn.Video.OverlayProxy.create(a);else{var d=a.url,b=Msn.Video.UrlHelper.getQspValue(d,"from");b="spawnOverlay"+(checkString(b)?"^"+b:"");openStandardWindow(Msn.Video.UrlHelper.addParamValueToQuery(d,"from",b,true),"_top")}return false};Msn.Video.buildSLWidget=function(f,h,e,a,c){var b={};for(var d in c)b[d]=c[d].replace(/\,/g,"%2c");var g=new Msn.VideoSL.Inline(a.divId);if(f!="slplayerad")e.innerHTML="<div id='"+a.divId+"_p'></div>";g.BuildPlayer(b,a.w,a.h,a.src,a.params)};Msn.Video.buildFlashWidget=function(g,f,a,d){var c="";for(i in d)c+=i+"="+d[i].replace(/\&/g,"%26")+"&";a.params["flashvars"]=c;var e=a.widgetId||a.divId+"_flash",b=new Msn.Video.FlashObject(e,a.src,a.w,a.h,a.params);b.setInstallCtrl(new Msn.Video.FlashInstall(a.downlevel),10);b.render(f);Msn.Video.flashObjects[a.divId]={id:e,flash:b};return b.getObjectNode()};Msn.Video.getWidgetEmbedAsset=function(b){var c=b.src.toLowerCase(),h=Msn.Video.Widgets[c]&&Msn.Video.Widgets[c].silverlight==true,a=getInitParam(b.flashvars,"version",null);if(!a||!Msn.Video.Widgets[c][a])a="current";var g=Msn.Video.getVersionedWidgetsPath(a),f=Msn.Video.Widgets[c][a],d=f.oldRoot?getCreateWidgetParamValue(b,"root","images.video.msn.com"):Msn.Video.UrlHelper.getWERoot(b);d=normalizeRootUrl(d);var e=format("{0}/{1}{2}",d,g,f.path);if(b.cacheBuster)e+="?rand="+Math.random();return e};Msn.Video.getVersionedWidgetsPath=function(a){return !a||"current"==a?Msn.Video.CountryCodeLoader.getVersionPath():""};Msn.Video.buildPlayerAdElements=function(c,a){var d='<div class="video1"><h3 id="'+a+'_t"></h3><div id="'+a+'_p"></div><div id="'+a+'_m"></div><div id="'+a+'_a" class="playerAdDiv"></div><div id="'+a+'_r"></div></div>';c.innerHTML=d;var b=document.getElementById(a+"_p");return b};function getCreateWidgetParamValue(a,b,d){var c=d;if(a.hasOwnProperty(b)&&checkDefined(a[b]))c=a[b];return c}function setParam(a,b,c){a[b.toLowerCase()]=c}function setIfNotSet(b,a,c){a=a.toLowerCase();if(!checkString(b[a]))b[a]=c}function getInitParam(b,c,d){var a=d||null;if(b&&checkString(c))a=b[c]||a;return a}function normalizeParamKeys(b){var a={};for(var c in b)a[c.toLowerCase()]=b[c];return a}function copyFlashVars(c,a){var e={};a=a.toLowerCase()+".";for(var d in c){var b=d.toLowerCase();if(b.indexOf(a)>=0||b.indexOf(".")<0)e[b.replace(a,"")]=c[d]}return e}Msn.Video.UrlHelper=new function(){var b="mkt",a=this;a.getWRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"wRoot","widgets.video.msn.com"))};a.getWERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"weRoot",Msn.Video.WidgetServer||"img.widgets.video.s-msn.com"))};a.getVCERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vceRoot","edge1.catalog.video.msn.com"))};a.getVCImgRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vciRoot","img1.catalog.video.msn.com"))};a.getQspValue=function(a,c){var g=def;if(a&&c){var e=d(a,c);if(e>0){var f=e+c.length+1,b=url.indexOf("&",f);if(b<0)b=a.length;g=a.substring(f,b)}}return g};function d(b,c){var a=b.indexOf("&"+c+"=");if(a<0)a=b.indexOf("?"+c+"=");if(a>=0)++a;return a}function c(b,a){return b+(checkString(a)?"="+a:"")}a.addQueryToUri=function(b,d,f){var e=b;if(checkString(d)){var g=c(d,f),a=b.split("?");e=a[0]+"?"+(checkArray(a,2)&&checkString(a[1])?a[1]+"&":"")+g}return e};a.addParamValuesToQuery=function(e,b,d){var f=d||false,a=e;for(var c in b)a=this.addParamValueToQuery(a,c,b[c],f);return a};a.addParamValueToQuery=function(g,f,i,j){var b=g,h=false,e=b.split("?");if(checkArray(e,2)){b=e[0];var k=e[1],m=f.toLowerCase(),a=k.split("&");if(checkArray(a,1))for(var d=0;d<a.length;d++)if(checkString(a[d])){var l=a[d].split("=")[0].toLowerCase();if(l==m){h=true;if(j){a[d]=c(f,i);b+="?"+a.join("&")}break}}}if(!h)b=this.addQueryToUri(g,f,i);return b};a.generateVideoPermalink=function(c,e){var a=null;if(checkDefined(c)&&checkString(c.permalink))a=c.permalink;else{var d=e.getValue("linkOverride2",null);if(!checkString(d)){d=e.getValue("linkOverride",null);if(checkString(d))d+="{0}"}if(checkString(d))a=format(d,c.uuid,c.shortId,e.getValue(b,"en-us"))}if(!checkString(a))a=Msn.Video.UrlHelper.getDefaultPermalink(c,e);else{var f=_cfgMgr.getValue("player","fr",_cfgMgr.getValue(b,""));a=Msn.Video.UrlHelper.addParamValueToQuery(a,"from",f,true)}return a};a.getDefaultPermalink=function(c,a){var d={vid:"{0}",mkt:"{2}",from:a.getValue("player","fr",a.getValue(b,""))},f=Msn.Video.UrlHelper.getLinkbackDomain(a),g=Msn.Video.UrlHelper.addParamValuesToQuery(f,d),e=format(g,c.uuid,c.shortId,a.getValue(b,"en-us"));return e};a.getLinkbackDomain=function(c){var b="video.msn.com",a=c.getValue("gmt","MsnLinkBackDomainUri",b);if(!checkString(a))a=c.getValue("d",b);if(a.indexOf("http://")!=0&&a.indexOf("https://")!=0)a="http://"+a;return a}};Msn.Video.JavascriptApi=window.Msn.Video.JavascriptApi||function(){var d="head",g="scriptId",f="Invalid Argument: filename is missing or is not a string",c=false,a=null,k=this,h=0,b={};function j(d,c){if(checkObject(b[d])){c=c||b[d].callback;var f=b[d].context;e(d);if(checkFunction(c))c(a,f,new Error("timed out waiting for script to load"))}}function e(c){if(checkObject(b[c])){if(checkDefined(b[c].timeout))clearTimeout(b[c].timeout);b[c]=a;delete b[c]}}return {makeRequest:function(i,d,g,e){if(!d)d=a;if(!e)e=c;var f=h++;b[f]={context:d,callback:g};Msn.Video.JavascriptApi.fetchScript(i+"&callbackName=Msn.Video.JavascriptApi.onComplete&cd="+f,f,a,e)},loadJS:function(e,d,g){if(!checkString(e))throw new Error(f);if(!d)d=a;if(!g)g=c;var k=c,j=document.getElementsByTagName("script");for(var i=0;i<j.length;i++)if(j[i].src.toLowerCase().indexOf(e)>=0){k=true;break}if(!k){var l=h++;b[l]={};Msn.Video.JavascriptApi.fetchScript(e,l,d,g)}else if(checkFunction(d))d()},fetchScript:function(m,h,i,k){if(!i)i=a;if(!k)k=c;var f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("src",m);f.setAttribute("id",g+h);if(checkFunction(i))if(f.readyState)f.onreadystatechange=function(){if("loaded"==f.readyState||"complete"==f.readyState){f.onreadystatechange=a;f=a;if(checkObject(b[h])){e(h);i()}}};else f.onload=function(){f.onload=a;f=a;if(checkObject(b[h])){e(h);i()}};if(k)b[h].timeout=setTimeout(function(){f.onreadystatechange=a;f.onload=a;f=a;j(h,i)},4e3);var l=document.getElementsByTagName(d)[0];l.appendChild(f)},onComplete:function(k,f,h){if(checkObject(b[f])){var j=b[f].context,i=b[f].callback;e(f);if(!checkDefined(h))h=a;i(k,j,h)}var c=document.getElementById(g+f);if(checkDefined(c))setTimeout(function(){var b=document.getElementsByTagName(d)[0];b.removeChild(c);c.onreadystatechange=a;c.onload=a;c=a},0)},loadCSS:function(b){if(!checkString(b))throw new Error(f);var d=c,a,h=document.getElementsByTagName("link");for(var e=0;e<h.length;e++){a=h[e].href;if(checkString(a)&&a.toLowerCase().indexOf(b)>=0){d=true;break}}var g=document.styleSheets;for(i=0;i<g.length;i++){a=g[i].href;if(checkString(a)&&a.toLowerCase().indexOf(b)>=0){d=true;break}}if(!d)Msn.Video.JavascriptApi.fetchCSS(b)},fetchCSS:function(c){var a=document.createElement("link");a.setAttribute("type","text/css");a.setAttribute("rel","stylesheet");a.setAttribute("href",c);var b=document.getElementsByTagName(d)[0];b.appendChild(a)},getCookie:function(b){var f=a;if(checkString(b)){b=b.toLowerCase();var e=document.cookie.split(";");for(var d=0;d<e.length;++d){var c=e[d].split("="),g=c[0].replace(/^\s+|\s+$/g,"").toLowerCase();if(g==b){if(c.length>1)f=c[1].replace(/^\s+|\s+$/g,"");break}}}return f},setCookie:function(e,d,b){var a=e.toLowerCase()+"="+d+";path=/";if(b!=0){var f=new Date,c=new Date(f.getTime()+b*1e3);a+=";expires="+c.toGMTString()}document.cookie=a+";domain="+document.domain;document.cookie=a+";domain=.video.msn.com"},getQSPs:function(b){b=b||(window.location&&"undefined"!=window.location.search?window.location.search.substring(1):"");var f={};if(checkString(b)){var e=b.split("&");for(var d=0;d<e.length;++d){param=e[d];if(param.length>0){var c=param.split("=");f[c[0].toLowerCase()]=c.length>1?unescape(c[1]).toLowerCase():a}}}return f},getQSPsFromUrl:function(b){var a=(new String(b)).split("?");if(2>a.length)throw new Error("Invalid param.url, malformed query string: "+param.url+"\nMake sure you encode urls in the query string.");return Msn.Video.JavascriptApi.getQSPs(a[1])},fraudDetectPing:function(a,e,f){var b="?t=10&u=13f40ac6-a267-471c-9672-8156713055d6&fi="+encodeURIComponent(a.url)+"&pl="+encodeURIComponent(document.location)+"&rl="+encodeURIComponent(document.referrer)+"&brs="+(window.innerWidth||document.documentElement.clientWidth)+"x"+(window.innerHeight||document.documentElement.clientHeight)+"&pv="+encodeURIComponent(window.navigator.userAgent)+"&from="+(a["from"]||a["mkt"]||"")+"&fr="+(a["player.fr"]||"")+"&flight="+(a["flight"]||"")+"&treat="+(a["treat"]||"")+"&mkt="+(a["mkt"]||"")+"&c8="+e+"&c9="+f+"&av=4",d=a["vc"]||"catalog.video.msn.com",c=h++;Msn.Video.JavascriptApi.fetchScript(normalizeRootUrl(d)+"/frauddetect.aspx"+b,c)}}}();Msn.Video.CountryCodeLoader=window.Msn.Video.CountryCodeLoader||function(){var c=null,d="CountryCode",b=Msn.Video.JavascriptApi.getCookie(d),a;return {getCountryCode:function(){return b},setCountryCode:function(a){b=(a||"").toLowerCase();var c=checkString(b)?7*24*60*60:-1;Msn.Video.JavascriptApi.setCookie(d,b,c)},loadCountryCode:function(a){if(!checkString(b)){var d="video.msn.com";if(checkString(Msn.Video.LocationServiceHost))d=Msn.Video.LocationServiceHost;var f="http://"+d+"/soapboxservice2.aspx?mn=GetCountryCode&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(f,c,function(b){e(b,a)},true)}else if(a)e(c,a)},getVersionPath:function(){if(!a){a="";if(Msn.Video.VersionTable){if(checkString(b)&&checkString(Msn.Video.VersionTable[b]))a=Msn.Video.VersionTable[b];else if(checkString(Msn.Video.VersionTable["global"]))a=Msn.Video.VersionTable["global"];if(0==a.indexOf("/"))a=a.slice(1);if(a.length-1!=a.lastIndexOf("/"))a+="/"}}return a}};function e(a,d){if(a&&checkObject(a.ReverseIPResult)&&checkObject(a.ReverseIPResult.StatusCode)&&checkString(a.ReverseIPResult.StatusCode.$)&&a.ReverseIPResult.StatusCode.$.toLowerCase()=="success"){var f=checkDefined(a.ReverseIPResult.CountryCode)?a.ReverseIPResult.CountryCode.$:c;if(checkString(f))Msn.Video.CountryCodeLoader.setCountryCode(f);var e=checkDefined(a.ReverseIPResult.Zip)?a.ReverseIPResult.Zip.$:c;if(checkString(e))Msn.Video.JavascriptApi.setCookie("ZipCode",e,7*24*60*60)}if(d&&"function"==typeof d)d(b)}}();Msn.Video.ResourceMgr=function(f,c){var e=this,b="default",a={};function d(a,f){if(checkDefined(f))b=f;if(a)for(var c=0;c<a.length;c++){var j=a[c].Key.toLowerCase(),h=a[c].Value;for(var d=0;d<h.length;d++){var g=h[d],i=g.Key.toLowerCase();e.setValue(j,i,g.Value)}}}this.getValue=function(b,c,e){var d=e;b=b.toLowerCase();c=c.toLowerCase();if(a.hasOwnProperty(b)&&a[b].hasOwnProperty(c))d=a[b][c];return d};this.setValue=function(d,e,g){if(null==d||d=="default")d=b;d=d.toLowerCase();e=e.toLowerCase();var f=e.indexOf(".");if(d==c&&f>0){d=e.substring(0,f);e=e.substr(f+1)}if(!a.hasOwnProperty(d))a[d]={};a[d][e]=g};d(f,c)};Msn.Video.loadConfiguration=function(a,f,h,i){var c="",d="",e="";if(checkDefined(a.flashvars)){var b=new Msn.Video.ConfigMgr(null,a.flashvars);c=b.getValue("mkt",c);d=b.getValue("configCsid","");e=b.getValue("configName","")}var j=Msn.Video.UrlHelper.getWERoot(a),g=j+"/resource.aspx?resources="+f+"&gmts="+h+"&mkt="+c+"&configCsid="+d+"&configName="+e+"&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(g,a,i)};Msn.Video.ConfigMgr=function(f,e,c){var a="default",b;function d(f,d,c){b=new Msn.Video.ResourceMgr(f,c);if(checkDefined(c))a=c;for(var e in d)b.setValue(null,e,d[e])}d(f,e,c);this.getValue=function(d,c,e){if(arguments.length==2){e=c;c=d;d=a}val=b.getValue(d,c,e);return val};this.setValue=function(c,d,e){if(arguments.length==2){e=d;d=c;c=a}if(c=="default")c=a;b.setValue(c,d,e)}};Msn.Video.CSS=function(){var a="undefined",b=null,d=["Moz","Webkit","O","Khtml"],c={};function e(j,f){var e=b;if(a==typeof c[f]){for(var g=0;g<d.length;g++){var i=d[g]+f;if(a!=typeof j.style[i]){e=i;break}e=b}if(b==e){var h=f.substr(0,1).toLowerCase(f)+f.substr(1);if(a!=typeof j.style[h])e=h}c[f]=e}else e=c[f];return e}return {setElementStyle:function(c,d,f){if(checkDefined(c)&&a!=typeof c.style){if(a==typeof c.style[d])d=e(c,d);if(b!=d)c.style[d]=f}},setStyle:function(a,d,c){if(checkArray(a))for(var b=0,e=a.length;b<e;++b)Msn.Video.CSS.setElementStyle(a[b],d,c);else Msn.Video.CSS.setElementStyle(a,d,c)},setCSS:function(c,a){for(var b in a)if(a.hasOwnProperty(b))Msn.Video.CSS.setStyle(c,b,a[b])},setOpacity:function(b,a){a=Math.max(0,Math.min(1,a));Msn.Video.CSS.setCSS(b,{filter:"alpha(opacity="+Math.round(a*100)+")",opacity:a})}}}();Msn.Video.VcLoader=function(n){var b=null,k="The embed code is improperly configured.",j="ErrorEmbedCode",f="player",a="",y=this,v="82",r="84",w="880",x=n,d=n.cfgMgr,m=n.resMgr,e,c,h,i,z,l=false,g;function u(){var x="supplier",n="source",u="hotvideo_top",t="ActiveStartDate",s="videoByTag.aspx",l="ed",b="1",G=d.getValue("leadWithPlugin",a)||d.getValue("player.leadWithPlugin",a);h="silverlight"==G.toLowerCase()?r:v;if(Msn.Video.isPluginsUnsupported)h=w;var q=d.getValue("mk","us"),o=d.getValue("c","v");switch(o){case "v":var F=d.getValue("v",a);if(checkString(F)){e="videoByUuids.aspx";c={uuids:F}}break;case "rel":var B=d.getValue("rel",a);if(checkString(B)){e="relatedVideos.aspx";c={mk:q,ps:b,ff:h,uuids:B}}break;case l:case "tag":var D=o==l?"MSNVideo_Top_Cat":d.getValue("ns","Public"),i=o==l?d.getValue(l,a):d.getValue("tag",a);if(checkString(D)&&checkString(i)){e=s;c={mk:q,ps:b,ff:h,vs:"0",sd:"-1",sf:t};if(D.toLowerCase()=="msnvideo_top_cat"){i=i.toLowerCase();if(i.indexOf(u)==0)i="top_top"+i.substr(u.length);if(i.indexOf("hotvideo_")==0){c.vs=b;c.sd=b;c.sf="VideoId"}else if(i.indexOf("top_top")==0){c.sd="-1";c.sf="HourlyCount"}}c.tag=i}break;case "s":var E=d.getValue("s",a);if(checkString(E)){e="search.aspx";c={mk:q,ps:b,ff:h,q:E}}break;case n:case x:var y=o==n?d.getValue(n,a):d.getValue(x,a),z=o==n?"VC_Source":"VC_Supplier";if(checkString(y)&&checkString(z)){var A=d.getValue("sort",a).toLowerCase();if(A=="random"){e="randomVideo.aspx";c={mk:q,c:b,ff:h,ns:z,tag:y}}else{e=s;c={mk:q,ps:b,ff:h,ns:z,vs:"0",tag:y,sd:"-1"};c.sf=A=="mostwatched"?d.getValue("timecount",a):t}}break;case "vcq":var C=d.getValue("vcq",a);if(checkString(C))p(C);break;default:g=m.getValue(f,j,k)}}function p(g){var a=g.split("?");if(a.length>0){e=a[0];c={};if(a.length>1){var d=a[1].split("&");for(var b=0;b<d.length;b++){var f=d[b].split("=");c[f[0]]=f[1]}c[e.toLowerCase()=="randomvideo.aspx"?"c":"ps"]=1;c.ff=h}}}this.error=function(){return g};this.load=function(n){i=n;if(!checkString(g)&&checkString(e)){c.rct="1,3,5,6";var a=normalizeRootUrl(d.getValue("vce",Msn.Video.UrlHelper.getVCERoot(x)))+"/"+e,h=a.indexOf("?")<0?"?":"&";for(var l in c){a+=h+l+"="+c[l];h="&"}a+=h+"responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(a,b,q)}else{if(!checkString(g))g=m.getValue(f,j,k);i(b,b,g)}};function q(d,e,c){if(checkString(c))if(!l)o();else i(b,b,c);else{var a=s(d);if(checkArray(a,1))i(a[0],b,b);else if(!l)o()}}function o(){l=true;var a=d.getValue(f,"defaultVcq",b);if(checkString(a)){p(a);y.load()}else{g=m.getValue(f,"ErrorNoVideos","Sorry, no videos were found.");i(b,b,g)}}function t(c){var q=b;if(c){var k=[],d;if(c.videoFiles)for(var e=0;e<c.videoFiles.videoFile.length;++e){d=c.videoFiles.videoFile[e];k.push({formatCode:d.$formatCode,url:d.uri.$,width:d.$width,height:d.$height})}var m=[],l;if(c.files)for(var f=0;f<c.files.file.length;++f){d=c.files.file[f];if(d.$formatCode=="2007")l=d.uri.$;m.push({formatCode:d.$formatCode,url:d.uri.$,width:d.$width,height:d.$height})}var p=[];if(c.tags)for(var g=0;g<c.tags.tag.length;++g){d=c.tags.tag[g];p.push({mkt:d.$market,ns:d.$namespace,value:d.$})}var n=[],j=a;if(c.extendedXml){if(c.extendedXml.relatedLinks&&c.extendedXml.relatedLinks.link)for(var h=0;h<c.extendedXml.relatedLinks.link.length;++h){d=c.extendedXml.relatedLinks.link[h];n.push({text:d.$,url:d.$url})}if(c.extendedXml.reportingData)j=c.extendedXml.reportingData.$}var o=[];if(c.usage)for(var i=0;i<c.usage.usageItem.length;++i){d=c.usage.usageItem[i];o.push({counterType:d.$counterType,dailyCount:d.$dailyCount,hourlyChange:d.$hourlyChange,hourlyCount:d.$hourlyCount,weeklyCount:d.$weeklyCount,monthlyCount:d.$monthlyCount,totalAverage:d.$totalAverage,totalCount:d.$totalCount})}q={title:c.title.$,description:c.description.$,uuid:c.uuid.$,shortId:c.uuid.$ref,csId:c.csId.$,source:c.source.$,sourceFriendly:c.source.$friendlyName,providerId:c.providerId.$,permalink:c.permalink?c.permalink.$:a,pageGroup:c.pageGroup.$,duration:c.durationSecs.$,durationSecs:c.durationSecs.$,ThumbUrl:l,reportingData:j,files:m,videoFiles:k,tags:p,relatedLinks:n,usage:o}}return q}function s(a){var c=[];if(a&&a.video)for(var b=0;b<a.video.length;++b){var d=t(a.video[b]);if(d)c.push(d)}return c}u()};Msn.Video.Player=function(){var s="linkback",r="currentVideoChanged",q="playbackStatusChanged",p="undefined",k="slplayerad",j="playerad",e="true",g="false",f="gmt",d="player",b=null,t=b,a,c,o,n,l,m,i;this.create=function(e,c){a=e;m=c;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,d,f,v);else v(b,a,b)};this.destroy=function(){E();m=b};function C(){var i="slplayer",h="downlevel",b;switch(c.getValue("leadwithplugin","").toLowerCase()){case "silverlight":b=true;break;case "flash":b=false;break;default:b=c.getValue(f,"leadWithSilverlight",g).toLowerCase()==e}if(b){if(!Silverlight.isInstalled("4.0")&&c.getValue(h,"").toLowerCase()!="install")b=false}else if(!Msn.Video.Plugins.hasFlash(10)&&c.getValue(h,"").toLowerCase()!="install")b=true;if(b)switch(a.src.toLowerCase()){case d:a.src=i;break;case j:a.src=k}else switch(a.src){case i:a.src=d;break;case k:a.src=j}}function v(D,E){var z="transparent",s="background",f="windowless",i="wmode",r="adDivs",y="MsnVideoInitializeInternal",x="leadwithimage";c=E.cfgMgr||new Msn.Video.ConfigMgr(D.configs,a.flashvars,d);o=E.resMgr||new Msn.Video.ResourceMgr(D.resources);var A=c.getValue(x,g).toLowerCase();if(A&&(A==e||A=="yes")){c.setValue(x,g);a.cfgMgr=c;a.resMgr=o;_leadWithImageCtrl=new Msn.Video.LeadWithImage;_leadWithImageCtrl.create(a,m)}else{n=a.widgetId;l=c.getValue("widgetGroup",b);if(p!=typeof MsnVideo2&&b!=MsnVideo2)u();else{t=window[y];window[y]=u}C();var w=a.src.toLowerCase(),v=document.createElement("div");v.setAttribute("id",a.divId+"_content");m.appendChild(v);var q={};for(var B in a.flashvars)if(b!=a.flashvars[B])q[B]=a.flashvars[B].replace(/\&/g,"%26");if(w==j||w==k){v=Msn.Video.buildPlayerAdElements(v,a.divId);q[r]=(checkString(q[r])?q[r]+";":"")+a.divId+"_a|300|60"}if(w.substring(0,6)==d&&!checkString(q["mode"]))q["mode"]="inline";a.params=a.params||{};var F=checkDefined(Msn.Video.Widgets[w].silverlight)?Msn.Video.Widgets[w].silverlight==true:false;a.src=Msn.Video.getWidgetEmbedAsset(a);h(i,a,c.getValue(i,undefined));h(f,a,c.getValue(f,undefined));h(s,a,c.getValue(s,undefined));if(undefined!=a.params[i])switch(a.params[i].toLowerCase()){case z:h(f,a,e);h(s,a,z);break;case "opaque":h(f,a,e);break;case "window":h(f,a,g)}if(F)Msn.Video.buildSLWidget(w,m,v,a,q);else Msn.Video.buildFlashWidget(m,v,a,q)}}function h(b,a,c){if(!a.params[b])a.params[b]=c}function u(){MsnVideo2.addMessageReceiver({eventType:q,widgetId:n,widgetGroup:l,funcCb:A});MsnVideo2.addMessageReceiver({eventType:r,widgetId:n,widgetGroup:l,funcCb:B});var a=MsnVideo2.getProperties({type:"currentVideo",widgetId:n,widgetGroup:l});if(b!=a&&a.length>0)w(a[0].param.video);if("function"==typeof t)t()}function E(){if(p!=typeof MsnVideo2&&b!=MsnVideo2){MsnVideo2.removeMessageReceiver({eventType:q,widgetId:n,widgetGroup:l});MsnVideo2.removeMessageReceiver({eventType:r,widgetId:n,widgetGroup:l})}}function B(a){var b=a.param.video;w(b)}function w(a){i=a;x()}function z(c){var b=document.getElementById(a.divId+"_t");if(b)b.innerHTML=c}function A(b){var a=b.param.status.toLowerCase();x("adplaying"==a||"adpaused"==a)}function x(p){var g="linkback last",m=checkObject(i);if(p)z(o.getValue(d,"ChannelsAdvertisement","Advertisement"));else z(m?i.title:"&nbsp");var h=document.getElementById(a.divId+"_m");if(h){var j,k;if(!p&&m&&checkArray(i.relatedLinks,1)&&i.sourceFriendly!=b){j=format(o.getValue(d,"ChannelsPartnerLink","Go to {0}"),i.sourceFriendly);k=i.relatedLinks[0].url}var l=checkString(k)&&checkString(j);h.innerHTML="";if(e==c.getValue(d,"msnlink",e)){var n=D();if(checkString(n)){var q=format(o.getValue(d,"ChannelsMoreText","View more {0} videos"),c.getValue(f,"brand","MSN"));h.appendChild(y(n,q,l?s:g))}}if(l)h.appendChild(y(k,j,g))}}function D(){var d="http://",a=c.getValue(s,b);if(!checkString(a)||a.indexOf(d)!=0){a=c.getValue(f,"MsnLinkBackDomainUri",b);if(checkString(a)){if(a.indexOf(d)!=0)a=d+a;var e={mkt:c.getValue("mkt","en-us"),brand:c.getValue("brand","MSN"),from:c.getValue("fr",b)||c.getValue("mkt",b)},h="",i="?";for(var g in e)if(checkString(e[g]))h+=format("{0}{1}={2}",i,g,e[g]);a+=h}}return a}function y(d,c,b){var a=document.createElement("A");a.href=d;a.innerHTML=c;a.className=b;return a}};Msn.Video.Gallery=function(){var d=null,c="gallery",i=this,a,b,h,g,e;this.create=function(h,b){a=h;e=b;g=a.widgetId;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,c,"gmt",f);else f(d,a,d)};function f(q,r){var i="wmode";b=r.cfgMgr||new Msn.Video.ConfigMgr(q.configs,a.flashvars,c);h=r.resMgr||new Msn.Video.ResourceMgr(q.resources);var l=document.createElement("div");l.setAttribute("id",a.divId+"_content");e.appendChild(l);if(Msn.Video.isPluginsUnsupported){if(b.getValue("gmt","useGalleryLinkback","false").toLowerCase()=="true"){var f=l;f.style.backgroundColor="#e0e0e0";f.style.color="#666";f.style.fontFamily="Tahoma";f.style.fontSize="8pt";f.style.fontWeight="bold";f.style.padding="30px";var m=b.getValue("player","fr",b.getValue(c,"from",b.getValue("mkt","")));m="gallery^fallback"+(checkString(m)?"^"+m:"");var t={mkt:b.getValue("mkt","en-us"),from:m},n=Msn.Video.UrlHelper.getLinkbackDomain(b);n=Msn.Video.UrlHelper.addParamValuesToQuery(n,t,true);var u=format(h.getValue(c,"LinkbackName","View more {0} videos"),b.getValue("gmt","brand","MSN")),j=document.createElement("a");j.setAttribute("href",n);j.setAttribute("target","_top");j.innerHTML=u;j.style.color="#07519a";f.appendChild(j)}}else{var o={};for(var p in a.flashvars)if(d!=a.flashvars[p])o[p]=a.flashvars[p].replace(/\&/g,"%26");a.params=a.params||{};a.src=Msn.Video.getWidgetEmbedAsset(a);if(b.getValue("playtype","inline")=="overlay"){var k=document.createElement("DIV");k.id=g+"OverlayPlayer";e.appendChild(k);var s=b.getValue("widgetGroup",d);Msn.Video.createWidget2({divId:k.id,src:"playeroverlay",w:300,h:300,flashvars:{widgetGroup:s},widgetId:k.id,weRoot:a.weRoot,cacheBuster:a.cacheBuster});o["gallery.playType"]="inline"}if(!a.params[i])a.params[i]=b.getValue(i,"transparent");return Msn.Video.buildFlashWidget(e,l,a,o)}}};Msn.Video.ArticlePlayer=function(){var b="DIV",c="player",a=null,t=this,l=a,h,j,o,e,d,i,q,g,k,f;this.create=function(b,d){e=b;q=d;if(!checkDefined(b.cfgMgr)||!checkDefined(b.resMgr))Msn.Video.loadConfiguration(b,c,"gmt",n);else n(a,b,a)};function n(M,N){var n="true",u="false",A="MsnVideoInitializeInternal";d=N.cfgMgr||new Msn.Video.ConfigMgr(M.configs,e.flashvars,c);i=N.resMgr||new Msn.Video.ResourceMgr(M.resources);h=e.widgetId;j=h+"InternalGroup";if("undefined"!=typeof MsnVideo2&&a!=MsnVideo2)m();else{l=window[A];window[A]=m}var p=d.getValue("compactMode",u);p=a!=p&&p.toLowerCase()==n;var z=d.getValue("showMetadata",n);z=a==z||z.toLowerCase()!=u;var B=document.createElement(b);B.className="msnVideoArticlePlayer";var J=d.getValue("fontSizeOverride",a);if(checkString(J))try{B.style.fontSize=J}catch(x){}q.appendChild(B);g=document.createElement(b);g.className=p?"compact":"normal";var G=d.getValue("backgroundcolor1",a);if(a!=G)try{g.style.backgroundColor=G}catch(x){alert("backgroundcolor1 configured incorrectly")}B.appendChild(g);k=document.createElement(b);k.className="playerDiv";var I=h+"PlayerDiv";k.id=I;g.appendChild(k);if(z||p){var v=document.createElement(b);v.className="upperDiv";f=document.createElement(b);f.className="metadataDiv";var D=d.getValue("fontcolor1",a);if(a!=D)try{f.style.color=D}catch(x){alert("fontcolor1 configured incorrectly")}v.appendChild(f);g.appendChild(v)}if(!p){var H=d.getValue("showBottomArea",n),t=a;if(a==H||H.toLowerCase()!=u){t=document.createElement(b);t.className="bottomDiv";var F=d.getValue("backgroundcolor2",a);if(a!=F)try{t.style.backgroundColor=F}catch(x){alert("backgroundcolor2 configured incorrectly")}g.appendChild(t);var y=document.createElement(b);y.className="browseMoreDiv";var E=document.createElement("IMG"),R=Msn.Video.UrlHelper.getWERoot(e);E.src=R+"/i/articleplayer/arrow.png";E.className="arrow";y.appendChild(E);var w=document.createElement("A"),P="http://video.msn.com?mkt="+d.getValue("mkt","en-us");w.href=d.getValue("linkback",P);if(d.getValue("pl",n).toLowerCase()==n)w.target="_blank";w.appendChild(document.createTextNode(i.getValue(c,"MoreVideosText","Browse more videos")));var Q=d.getValue("fontColor3",a);if(a!=D)try{w.style.color=Q}catch(x){alert("fontColor3 configured incorrectly")}y.appendChild(w);t.appendChild(y)}}var C=document.createElement(b),K=h+"adDiv";C.id=K;C.className="adDiv";if(p){v.appendChild(C);var L=document.createElement(b);L.className="clear";v.appendChild(L)}else if(a!=t)t.appendChild(C);var r={};for(var O in e.flashvars)r[O]=e.flashvars[O];r["widgetId"]=o;r["adDivs"]=K+"|300|60";r["widgetGroup"]=j;r["rst"]="ArticlePlayer";r["fontsizeoverride"]=a;Msn.Video.createWidget2({divId:I,src:s(),w:e.w,h:e.h,flashvars:r,widgetId:o,root:e.root,weRoot:e.weRoot,vceRoot:e.vceRoot,cacheBuster:e.cacheBuster})}function s(){var a="slplayer";if(d.getValue("leadwithplugin","silverlight").toLowerCase()=="flash")a=c;return a}function p(e){var k=":</span> ",g="</span>",t=d.getValue("fontColor2",a),l="";if(a!=t)l=" style='color: "+t+"'";f.innerHTML="";var q=document.createElement(b);q.className="titleDiv";q.innerHTML=e.title;f.appendChild(q);var p=document.createElement(b);p.className="detailDiv";var r=new Date(e.startDate),x=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear(),s="<div><span class='dateDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"DateLbl","Date")+":</span>"+x+g,j=60*60,h=e.durationSecs,v=Math.floor(h/j);h%=j;j/=60;var u=Math.floor(h/j);h%=j;var y=Math.floor(h),n="";if(v>0)n+=padLeft(v,2,"0")+":";var w=u>0?2:1;n+=padLeft(u,w,"0")+":"+padLeft(y,2,"0");s+="<span class='durationDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"DurationLbl","Duration")+k+n+g;var o;if(e.relatedLinks.length>0&&checkString(e.relatedLinks[0].url))o="<a class='videoByLink' href='"+e.relatedLinks[0].url+"' target='_blank'>"+e.sourceFriendly+"</a>";else o=e.sourceFriendly;s+="<span class='sourceDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"VideoByLbl","Video By")+k+o+g;p.innerHTML=s;f.appendChild(p);var m=document.createElement(b);m.className="descriptionDiv";m.innerHTML=e.description;f.appendChild(m)}function r(a){var b=a.param.video;p(b)}function m(){MsnVideo2.addMessageReceiver({eventType:"currentVideoChanged",widgetId:h,widgetGroup:j,funcCb:r});var b=MsnVideo2.getProperties({type:"currentVideo",widgetId:h,widgetGroup:j});if(a!=b&&b.length>0)p(b[0].param.video);if("function"==typeof l)l()}};Msn.Video.OverlayPlayerLookup=window.Msn.Video.OverlayPlayerLookup||{};Msn.Video.OverlayPlayer=function(){var Qb="loadVideo",rb="widgetLoaded",Pb="rect(0px,0px,0px,0px)",qc="playlistCompleted",Ob="queueVideo",Nb="stopVideo",pc="playVideo",Mb="/image.aspx?w=128&h=72&so=4&uuid=",K="visible",g="block",ab="share",Wb="Check out this great {0} video",Vb="ShareTextMessageCommon",ib="brand",Ub="fontsizeoverride",Tb="widgetId",D="hidden",hb="resize",c=true,i="px",e="",f="none",o="true",gb="MsnVideoInitializeInternal",L="undefined",fb="OverlayPlayer",eb="widgetGroup",Sb="_playerDiv",s="gmt",d="player",b=false,a=null,Ed=this,mb=a,k,r,nb,Ab,A,w,m,v,h,l,E,Tc,rd=30,cc=0,od=5,kb=b,Lc,u,t,H,C,Db,B,R,p,J,qb,Hc,n,V,N,gc,I,U,x,O,Ib=b,ub,Kc=135,Hd,wc=640,Wc=wc+15+Kc,yb=15+360+5+90+15,zc=yb+65,bb,Z=yb,vc=yb/2+65,cb=b,Y,Oc=640,j,G=a,fc=b,P,sb,X,z,Hb,Bb,Eb,Jb,vb=b,F,bc,Fb,wb,W,Pc,ec,lc,dc=["ad","adpartial","adfull","timeplaying","videosplayed","timeelapsed","playadbeforefirstvid"],jb=[],Xb=0,xb,pb=b,oc=b,Nc=1e3,Jc=650,y,Yb,M,Lb,nc=b,hc=b,ac=b,Gd=b,ob=b,Ec;this.create=function(b){v=b;if(!checkDefined(b.cfgMgr))Msn.Video.loadConfiguration(b,d,s,Dc);else Dc(a,b,a)};this.destroy=function(){T();sd();Msn.Video.destroyWidget(k+Sb);Msn.Video.destroyWidget(Ab);document.body.removeChild(u);u=a;Msn.Video.OverlayPlayerLookup[r]=a;delete Msn.Video.OverlayPlayerLookup[r]};function Dc(c,e){h=e.cfgMgr||new Msn.Video.ConfigMgr(c.configs,v.flashvars,d);l=e.resMgr||new Msn.Video.ResourceMgr(c.resources);r=h.getValue(eb,a);var b=checkString(r)?r:"*";if(Msn.Video.OverlayPlayerLookup.hasOwnProperty(b))Msn.Video.OverlayPlayerLookup[b].destroy();Msn.Video.OverlayPlayerLookup[b]=Ed;k=v.widgetId||fb;A=k+"GalleryInternalGroup";m=k+"PlayerInternalGroup";w=k+"InternalPlayer";nb=k+"InternalGallery";Ab=nb+"Div";E=Msn.Video.UrlHelper.getWERoot(v);if(L==typeof MsnVideo2||a==MsnVideo2){mb=window[gb];window[gb]=xc;Msn.Video.JavascriptApi.fetchScript(E+"/js/widgetframework.js","OverlayPlayerWidgetFramework")}if(!Msn.Video.isPluginsUnsupported)Dd()}function Dd(){var gb="leadWithPlugin",db="headerImage",cb="arrow_right",ab="descriptionDiv",Z="titleDiv",V="closeImg",T="0 0 10px black",A="BoxShadow",S="adSkinDiv",b="DIV",s="false";Bc();ad();Tc=h.getValue("animateOpen",s)==o;u=document.createElement(b);u.style.display=f;u.className="msnVideoOverlayPlayer";document.body.appendChild(u);var ib=l.getValue(d,"clickToClose","click to close");t=document.createElement(b);t.className="overlayDiv";if(!Msn.Video.isChrome&&!Msn.Video.isSafari)t.title=ib;Msn.Video.CSS.setOpacity(t,.6);u.appendChild(t);H=document.createElement(b);H.className="centerDiv";u.appendChild(H);C=document.createElement(b);C.className="positionAdj";if(!Msn.Video.isChrome&&!Msn.Video.isSafari)C.title=ib;H.appendChild(C);y=document.createElement(b);Yb=k+S;y.id=Yb;y.className=S;y.title=Msn.Video.isFirefox?" ":e;C.appendChild(y);bb=wc;x=document.createElement(b);x.className="contentWrapper";x.style.width=bb+i;Msn.Video.CSS.setElementStyle(x,A,T);x.title=Msn.Video.isFirefox?" ":e;C.appendChild(x);var j=document.createElement(b);j.className=V;j.title=ib;var pb=E+"/i/overlayplayer/close_btn.png";if(Msn.Video.isIE&&checkDefined(j.style.filter)){j.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '"+pb+"')";j.style.backgroundImage=f}else{var yb=document.createElement("IMG");yb.src=pb;j.appendChild(yb)}U=j;I=j.cloneNode(c);I.className=V;I.title=ib;x.appendChild(U);O=document.createElement(b);O.className="contentWrapperInner";x.appendChild(O);var N=document.createElement(b);N.className="leftContainer";O.appendChild(N);var jb=document.createElement(b);jb.className="playerDiv";jb.style.width=Oc+i;var rb=k+Sb;jb.id=rb;N.appendChild(jb);var r=document.createElement(b);r.className="bottomContainer";Msn.Video.CSS.setElementStyle(r,A,"0 0 6px black");var tb=h.getValue("fontSizeOverride",a);if(checkString(tb))try{r.style.fontSize=tb}catch(Cb){}N.appendChild(r);P=document.createElement(b);P.className="metadataWrapper";P.style.display=f;r.appendChild(P);var lb=document.createElement("TABLE");lb.className="metadataTable";P.appendChild(lb);var ob=document.createElement("TBODY");lb.appendChild(ob);var nb=document.createElement("TR");ob.appendChild(nb);var q=document.createElement("TD");q.style.width="100%";nb.appendChild(q);var K=document.createElement(b);K.className="metadataDiv";q.appendChild(K);sb=document.createElement(b);sb.className=Z;K.appendChild(sb);Qc(sb,hb,zb);X=document.createElement(b);X.className=ab;K.appendChild(X);z=document.createElement(b);z.className="shareDiv";K.appendChild(z);var mb=document.createElement(b);mb.className="shareText";mb.appendChild(document.createTextNode(l.getValue(d,"EndSlateShare","Share")));z.appendChild(mb);Hb=Gb(a,"icon_mail","icon_mail_hover",l.getValue(d,"ChannelsShareEmail","E-mail this video to a friend"),"mailIcon");z.appendChild(Hb);Bb=Gb(a,"icon_face","icon_face_hover",l.getValue(d,"FacebookShareText","Facebook"),"facebookIcon");z.appendChild(Bb);Eb=Gb(a,"icon_twit","icon_twit_hover",l.getValue(d,"TwitterShareText","Twitter"),"twitterIcon");z.appendChild(Eb);Jb=Gb(l.getValue(d,"MoreShareText","More"),cb,cb,l.getValue(d,"MoreShareToolTip","More sharing options"),"moreIcon");z.appendChild(Jb);q=document.createElement("TD");q.className="overlayAdCell";nb.appendChild(q);Lb=k+"adDiv";M=document.createElement(b);M.id=Lb;M.className="overlayAdDiv";q.appendChild(M);F=document.createElement(b);F.className="upNextWrapper";F.style.display=f;r.appendChild(F);var G=document.createElement(b);G.className="countdown";G.appendChild(document.createTextNode(l.getValue(d,"EndSlateUpNext","UP NEXT").toUpperCase()));G.appendChild(document.createElement("BR"));F.appendChild(G);W=document.createElement(b);W.className="count";G.appendChild(W);wb=document.createElement("IMG");wb.className="thumbImg";F.appendChild(wb);var Q=document.createElement(b);Q.className="upNextMeta";F.appendChild(Q);bc=document.createElement(b);bc.className=Z;Q.appendChild(bc);Fb=document.createElement(b);Fb.className=ab;Q.appendChild(Fb);var kb=document.createElement(b);kb.className="rightContainer";O.appendChild(kb);ub=document.createElement(b);ub.id=Ab;ub.className="galleryDiv";kb.appendChild(ub);Db=s!=h.getValue("header",s).toLowerCase();B=document.createElement(b);B.className=db;B.style.visibility=D;Msn.Video.CSS.setElementStyle(B,A,T);B.title=Msn.Video.isFirefox?" ":e;C.appendChild(B);R=document.createElement(b);R.className="headerImageInner";B.appendChild(R);p=document.createElement("IMG");p.width=830;p.height=65;J=h.getValue(db,a);p.onload=function(){p.onload=a;jc(J)};if(checkString(J))p.src=J;qb=h.getValue("headerLinkback",a);R.appendChild(p);n=p.cloneNode(c);n.style.display=f;n.width=830;n.height=65;R.appendChild(n);B.appendChild(I);var g=copyFlashVars(v.flashvars,d);setParam(g,Tb,w);setParam(g,eb,m);setParam(g,"rst",fb);setParam(g,"adDivs",Yb+"|"+Nc+"|"+Jc+";"+Lb+"|300|60");setParam(g,Ub,a);setIfNotSet(g,"ap",o);setIfNotSet(g,"rvp",o);setIfNotSet(g,"slatetime","0");setIfNotSet(g,"hideplaylist",o);setIfNotSet(g,"initPanel",f);if(a==h.getValue(gb,a)&&a==h.getValue("player.leadWithPlugin",a))setIfNotSet(g,gb,"silverlight");Msn.Video.createWidget2({divId:rb,src:d,w:Oc,h:360,flashvars:g,widgetId:w,weRoot:v.weRoot,cacheBuster:v.cacheBuster});Y=a;var xb=h.getValue("playonloaduuid",a);if(a!=xb)Y={uuid:xb};else{var vb=h.getValue("playonloadref",a);if(a!=vb)Y={shortId:vb}}if(L!=typeof MsnVideo2&&a!=MsnVideo2)xc()}function Gb(i,h,g,l,c){var f="{0}/i/overlayplayer/{1}.png",b="url({0}/i/overlayplayer/{1}.png)",d="shareButton ",a=document.createElement("A");a.className=d+(c?c:e);a.title=l;if(i)a.appendChild(document.createTextNode(i));if(Msn.Video.IEVersion>=6&&Msn.Video.IEVersion<8){a.className="shareButtonIE7 "+(c?c:e);a.style.backgroundImage=format(b,E,g)}else{a.className=d+(c?c:e);var j=new Image;j.src=format(f,E,h);var k=new Image;k.src=format(f,E,g);a.style.backgroundImage=format(b,E,h);a.onmouseover=function(){a.style.backgroundImage=format(b,E,g)};a.onmouseout=function(){a.style.backgroundImage=format(b,E,h)}}return a}function ed(){var a=h.getValue(s,ib,"MSN"),b=format("mailto:?subject={0}&body={1}%0D%0A%0A{2}%0D%0A{3}%0D%0A%0A{4}",encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailSubject","Check out this video from {0}!"),a)),encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailMessage","Check out this video from {0}:"),a)),encodeURIComponent(j.title),encodeURIComponent(Msn.Video.UrlHelper.generateVideoPermalink(j,h)).replace(/%20/g,"%2520"),encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailSignature"),h.getValue(s,"subbrand","The MSN Video Team"))));window.open(b)}function bd(){var c=encodeURIComponent(yc("facebook")),b=encodeURIComponent(format(l.getValue(d,Vb,Wb),h.getValue(s,ib,"MSN"))),a=format("http://www.facebook.com/sharer.php?u={0}&t={1}%3a+{2}",c,b,encodeURIComponent(j.title));openStandardWindow(a,"_overlayFacebook")}function cd(){var b=encodeURIComponent(yc("twitter")),a=encodeURIComponent((format(l.getValue(d,Vb,Wb),h.getValue(s,ib,"MSN"))+": "+j.title).substring(0,100));openStandardWindow(format("http://twitter.com/share?url={0}&text={1}",b,a),"_overlayTwitter")}function Rc(){var a=vb?"closePane":"openPane";q({type:a,targetId:w,targetGroup:m,param:{paneType:ab}})}function yc(a){var b=Msn.Video.UrlHelper.generateVideoPermalink(j,h);if(checkString(a))a="-"+a;return Msn.Video.UrlHelper.addParamValueToQuery(b,"from","sharepermalink"+a,c)}var mc={};function ad(){var d=h.getValue(s,"sourceHeaderImages",a);if(checkString(d)){var e=d.split(";");for(var c=0;c<e.length;++c){var b=e[c].split(":");if(checkArray(b,2))mc[b[0]]=b[1]}}}function jc(a){if(a==V)gc=c;else if(a==J)Hc=c;Q()}function yd(d){var c=document.images;for(var a=0;a<c.length;a++)if(c[a].src==d)return c[a];return b}function jd(c){var b=a;if(c&&checkString(c)){b=yd(c);if(!b||!checkString(b.src)){b=new Image;b.onload=function(){b.onload=a;jc(c)};b.src=c}}return b}function Sc(k){if(Db){var d=b,i=c;if(k&&checkString(j.source)&&checkString(mc[j.source])){var h=format("{0}/i/header/{1}",E,encodeURIComponent(mc[j.source]));if(h!=V){gc=b;V=h;var l=jd(V);if(l){n.onload=function(){_sourceHeadearImage.onload=a;jc(V)};n.src=V}}if(gc){N=checkArray(j.relatedLinks,1)?j.relatedLinks[0]:a;var m=N&&checkString(N.url);p.style.display=f;n.style.display=g;if(m){n.title=checkString(N.text)?N.text:e;n.style.cursor=MsnVideo.IEVersion<6?"hand":"pointer"}else{n.title=e;n.style.cursor="default"}d=c;i=b}}if(i){n.style.display=f;if(Hc){p.style.display=g;if(checkString(qb))p.style.cursor=Msn.Video.IEVersion<6?"hand":"pointer";else p.style.cursor="default";d=c}else uc()}if(d){I.style.display=g;U.style.display=f;B.style.visibility=K;Z=zc}}}function uc(){B.style.visibility=D;I.style.display=f;U.style.display=g;Z=yb}function Q(){if(j&&Ib&&!ac&&Db){if(j.isFailed||!j.isReady)Sc(b);else Sc(c);vc=Z/2+(zc-Z)}else uc()}function qd(b){if(!b)b=window.event;rc(b);var a;if(p.style.display==g)a=qb;else if(n.style.display==g&&checkDefined(N))a=N.url;if(checkString(a)){q({type:"pauseVideo",targetId:w,targetGroup:m});openStandardWindow(a,"_linkback")}}function Cb(b,a){clearInterval(Pc);clearTimeout(Lc);if(kb){if(b){P.style.display=g;zb()}else P.style.display=f;if(a){F.style.display=g;Pc=setInterval(id,500)}else F.style.display=f}}function id(){var b=MsnVideo2.getProperties({type:"currentAdPosition",sourceId:k,sourceGroup:m});if(checkArray(b,1)){var a=b[0].param.duration-b[0].param.position;if(!isNaN(a))if(a>=1)db(W,pd(parseInt(a)));else{db(W,e);ob=c;Ic()}}}function pd(a){var b=parseInt(a/60);a=a%60;return format("{0}:{1}{2}",b||e,a>9?e:"0",a)}function md(c){var f=h.getValue(c,e);if(checkString(f)){var b=f.split("|");for(var a=0;a<b.length;a++)if(a<jb.length)jb[a][c]=b[a];else{var d={};d[c]=b[a];jb.push(d)}}}function Bc(){jb=[];for(var a=0;a<dc.length;a++)md(dc[a])}function xd(f,e){var a=b,d=f[e];if(checkDefined(d)){h.setValue(e,d);a=c}return a}function wd(c){if(c&&checkDefined(c.param)&&checkDefined(c.param.configs)){var a=normalizeParamKeys(c.param.configs),f=b;for(var d=0;d<dc.length;d++)f|=xd(a,dc[d]);if(f)Bc();Ec=a["gallery.categoryrequests"]||a["categoryrequests"];var e=a["player.header"]||a["header"];if(checkString(e))Db=o==e;J=a["player.headerimage"]||a["headerimage"]||J;qb=a["player.headerlinkback"]||a["headerlinkback"]||qb;p.src=J;Q()}}function Mc(){if(Xb<jb.length){q({type:"setAdvertisingOptions",targetId:w,targetGroup:m,param:jb[Xb]});Xb++}}function rc(a){if(!a)a=window.event;a.cancelBubble=c;if(a.stopPropagation)a.stopPropagation()}function db(a,b){if(checkDefined(a.innerText))a.innerText=b;else a.textContent=b}function nd(a,b,d){if(d>0){var c=Bd(a,b,d);a.innerHTML=c;a.title=c!=b?b:e}}function Bd(e,d,h){var i=d,a=e.cloneNode(c);a.style.position="absolute";a.style.visibility=D;a.style.display=g;a.style.overflow=K;a.style.maxHeight=f;a.style.height="auto";a.innerHTML=d;e.parentNode.insertBefore(a,e.nextSibling);if(a.offsetHeight>h){var j="&hellip;",l=0,b=d.length;do{var k=(l+b)/2;a.innerHTML=d.substr(0,k)+j;if(a.offsetHeight>h)b=k-1;else l=k+1}while(l<b);i=a.innerHTML=d.substr(0,b)+j;while(a.offsetHeight>h&&b>0){--b;i=a.innerHTML=d.substr(0,b)+j}}e.parentNode.removeChild(a);return i}var sc;function zb(){if(sc){var a=Yc();X.style.height=a+i;nd(X,sc,a)}}function tb(b,a){sc=a;db(sb,b);zb();db(bc,b);db(Fb,a)}function Gc(b){j=b;if(b.isFailed){var e=l.getValue(d,"errorMetaData","cannot load metadata");tb(e,e);Lc=setTimeout(T,5e3)}else if(b.isReady){tb(b.title,b.description);wb.src=Msn.Video.UrlHelper.getVCImgRoot(v)+Mb+b.uuid;z.style.visibility=K;q({type:pc,targetId:w,targetGroup:m});G=a;Rb()}else{var c=l.getValue(d,"loadingMetaData","loading ...");tb(c,c)}Q()}function Ac(a){a.sourceGroup=r;a.targetGroup=r;q(a);a.sourceGroup=A;a.targetGroup=A;q(a);Gc(a.param.video)}function vd(a){if(checkDefined(a)&&checkDefined(a.param)&&a.param.paneType==ab)vb=c}function ud(a){if(checkDefined(a)&&checkDefined(a.param)&&a.param.paneType==ab)vb=b}function Zc(g){var e="adplaying",d="videoplaying",a="videoopening",f=g.param.status.toLowerCase();if(!kb)switch(f){case a:case "videobuffering":case d:case "adopening":case e:q({type:Nb,targetId:w,targetGroup:m})}switch(f){case a:oc=b;break;case d:pb=c;ob=c;if(xb){Mc();xb=b}Cb(c,b);break;case e:ac=c;Q();if(!pb)Cb(b,c);if(oc)gd();break;case "adplaycompleted":case "adplayfailed":Fc();Q();break;case "videoplaycompleted":case "videoplayfailed":oc=c;ob=c;Rb();break;case "playbackcompleted":case "playbackstopped":pb=b;xb=c}Kb();Ic()}function td(a){if(a.param.id==Yb){nc=c;Kb()}else if(a.param.id==Lb){hc=checkString(M.innerHTML);Kb()}}function kd(){Rb()}function gd(){if(a!=G){tb(G.title,G.description);Cb(b,c);wb.src=Msn.Video.UrlHelper.getVCImgRoot(v)+Mb+G.uuid}}function Cc(){if(a!=G)q({type:Ob,targetId:w,targetGroup:m,param:{video:G}});else{fc=c;Rb()}}var ic=b;function Rb(){if(a==G){ic=c;q({type:qc,sourceId:k,sourceGroup:A,targetId:nb,targetGroup:A})}}function fd(a){if(a.type.toLowerCase()=="queuevideo"&&ic){ic=b;G=a.param.video;if(fc){fc=b;Cc()}}else{a.targetGroup=m;q(a)}}function Fc(){ac=b;nc=b;y.innerHTML=e}function Kb(){if(checkDefined(y)){var b=nc&&ac;y.style.display=b?g:f}if(checkDefined(M)){var a=hc&&pb;M.style.display=a?g:f}}function Qc(a,c){if(a.attachEvent)a.attachEvent("on"+c,lb);else a.addEventListener(c,lb,b)}function hd(){H.onclick=T;t.onclick=T;C.onclick=T;y.onclick=rc;x.onclick=rc;U.onclick=T;I.onclick=T;R.onclick=qd;Hb.onclick=ed;Bb.onclick=bd;Eb.onclick=cd;Jb.onclick=Rc}function dd(){H.onclick=a;t.onclick=a;C.onclick=a;y.onclick=a;x.onclick=a;U.onclick=a;I.onclick=a;R.onclick=a;Hb.onclick=a;Bb.onclick=a;Eb.onclick=a;Jb.onclick=a}function Cd(d){H.style.clip=Pb;tb(e,e);db(W,e);M.innerHTML=e;hc=b;Fc();Kb();var a=Ad();u.style.top=a.scrollY+i;t.style.top=-a.scrollY+i;t.style.left=-a.scrollX+i;O.style.visibility=D;t.style.display=g;u.style.display=g;Qc(window,hb,lb);hd();kb=c;lb();cc=0;Vc(d)}function Yc(){return Math.max(0,Uc(z).y-Uc(X).y)}function lb(){var c=f!=y.style.display,a=document.body,b=document.documentElement;t.style.width=Math.max(c?Nc:bb,a.clientWidth,b.clientWidth,a.scrollWidth,b.scrollWidth,a.offsetWidth,b.offsetWidth)+i;t.style.height=Math.max(c?Jc:Z,a.clientHeight,b.clientHeight,a.scrollHeight,b.scrollHeight,a.offsetHeight,b.offsetHeight)+i;zb()}function Vc(a){if(Tc&&cc<=110){cc+=od;var c=cc/100,d=bb/2*c,e=Z/2*c,f="rect("+Math.round(vc-e)+"px,"+Math.round(d)+"px,"+Math.round(vc+e)+"px,"+Math.round(-d)+"px)";H.style.clip=f;setTimeout(function(){Vc(a)},rd)}else{H.style.clip="rect(0px,500px,650px,-500px)";O.style.visibility=K;q({type:"overlayOpened",sourceGroup:r,targetGroup:r});lc=b;if(a)a()}}function Ad(){var a=document.body,c=a.scrollTop,b=a.scrollLeft;if(0==c)if(window.pageYOffset)c=window.pageYOffset;else c=a.parentElement?a.parentElement.scrollTop:0;if(0==b)if(window.pageXOffset)b=window.pageXOffset;else b=a.parentElement?a.parentElement.scrollLeft:0;return {scrollY:c,scrollX:b}}function Uc(a){var b=0,c=0;while(a){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent}return {x:b,y:c}}function T(){var a=kb;kb=b;C.style.clip=Pb;z.style.visibility=D;uc();if(!Msn.Video.isChrome||cb)u.style.display=f;else lc=c;if(Msn.Video.isFirefox||Msn.Video.isChrome)cb=b;ec={type:Nb,targetId:w,targetGroup:m};if(cb)q(ec);Cb(b,b);pb=b;ob=b;if(vb){Rc();vb=b}if(window.detachEvent)window.detachEvent("onresize",lb);else window.removeEventListener(hb,lb,b);dd();if(a&&L!=typeof MsnVideo2)q({type:"overlayClosed",sourceGroup:r,targetGroup:r})}function kc(a){Xb=0;Mc();xb=c;a.targetId=w;a.targetGroup=m;q(a)}function tc(c){if(Msn.Video.isPluginsUnsupported){var f=Msn.Video.UrlHelper.getDefaultPermalink(c.param.video||{uuid:msn.param.uuis,shortId:a},h);openStandardWindow(f,"_top")}else{j=a;Ib=b;ub.innerHTML=e;var d=a;if(!cb)ec=c;else if(kb)kc(c);else d=function(){kc(c)};Cd(d)}}function ld(){cb=c;kc(ec);if(Msn.Video.isChrome&&lc){u.style.display=f;cb=b}}function zd(b){var c="us";for(var d in b.tags){var a=b.tags[d];if(checkDefined(a)&&checkString(a.mk))c=a.mk}return c}function Ic(){if(!Ib&&a!=j&&ob){bb=Wc;x.style.width=bb+i;var d=Ec||encodeURI("relatedVideos.aspx?uuids="+j.uuid+"&mk="+zd(j)+"&alg=0&ff=81&ind=3&ps=12&rct=1,2,3,4,5,6"),b=copyFlashVars(v.flashvars,"gallery");setParam(b,"configcsid","MSNvideo");setParam(b,"configname","divoverlaygallery");setParam(b,Tb,nb);setParam(b,eb,A);setParam(b,"rst",fb);setParam(b,"smartPoolCtx","oGal");setParam(b,"playtype","inline");setParam(b,Ub,a);setIfNotSet(b,"categoryRequests",d);setIfNotSet(b,"cp",o);setIfNotSet(b,"rvp",o);Msn.Video.createWidget2({divId:Ab,src:"gallery",w:Kc,h:455,flashvars:b,widgetId:nb,weRoot:v.weRoot,cacheBuster:v.cacheBuster});Ib=c;Q()}}var S=[{eventType:rb,handler:ld},{eventType:Qb,handler:tc,external:c},{eventType:Ob,handler:tc,external:c},{eventType:"setConfigs",handler:wd,external:c},{eventType:"currentVideoChanged",handler:Ac},{eventType:"currentVideoDataUpdated",handler:Ac},{eventType:"playbackStatusChanged",handler:Zc},{eventType:"companionAdRendered",handler:td},{eventType:"paneOpened",handler:vd},{eventType:"paneClosed",handler:ud},{eventType:qc,handler:Cc}],Zb=[Ob,Qb,pc];function xc(){for(var b=0;b<S.length;++b){var e=S[b].external&&S[b].external;MsnVideo2.addMessageReceiver({eventType:S[b].eventType,widgetId:k,widgetGroup:e?r:m,funcCb:S[b].handler})}for(var c=0;c<Zb.length;c++)MsnVideo2.addMessageReceiver({eventType:Zb[c],widgetId:k,widgetGroup:A,funcCb:fd});MsnVideo2.addMessageReceiver({eventType:rb,widgetId:k,widgetGroup:A,funcCb:kd});var d=MsnVideo2.getProperties({type:"currentVideo",sourceId:k,sourceGroup:m});if(checkArray(d,1))Gc(d[0].param.video);if("function"==typeof mb){mb();mb=a}setTimeout(Xc,0)}function Xc(){if(checkObject(Y)){var b=Y;Y=a;b.playSource="OverlayPlayer:spawn::"+(b.uuid?"uuid":b.shortId?"shortId":a);tc({type:Qb,param:b})}}function sd(){if(L!=typeof MsnVideo2&&a!=MsnVideo2){for(var b=0;b<S.length;++b)MsnVideo2.removeMessageReceiver({eventType:S[b].eventType,widgetId:k,widgetGroup:m});for(var c=0;c<Zb.length;c++)MsnVideo2.removeMessageReceiver({eventType:Zb[c],widgetId:k,widgetGroup:A});MsnVideo2.removeMessageReceiver({eventType:rb,widgetId:k,widgetGroup:A})}else window[gb]=mb||a}function q(a){MsnVideo2&&MsnVideo2.sendMessage(a)}};Msn.Video.OverlayProxy=function(){var b="from",a="player.fr",d="undefined",c,g;function f(b,a){if(d!=typeof window.MsnVideoUx&&checkFunction(window.MsnVideoUx.launchOverlayPlayer))e(b,a);else Msn.Video.JavascriptApi.loadJS("http://"+Msn.Video.V5AssetHost+"/s/js/vxp.js",function(){e(b,a)})}function e(i,c){var f="player.reportingtype";if(d!=typeof window.MsnVideoUx&&checkFunction(window.MsnVideoUx.launchOverlayPlayer)){var e={},h=c.name||"default",j=c.csid||"ux-en-us";e.MmvLite="true";e.UseHtml5PlayerOnly="false";if(checkInt(c.initialmoduleindex))if(c.initialmoduleindex>0)e.InitialModuleIndex=c.initialmoduleindex;else if(c.playonloaduuid||c.playonloadref){h="vxp_launch_empty";e.DynamicInitialVideoId=c.playonloaduuid||c.playonloadref;e.DynamicModules="video";if(c.dynamicplaylistquery)e.DynamicPlayistQuery=c.dynamicplaylistquery}if(checkString(c[a]))e.DynamicReportingFr=c[a];if(checkString(c[f]))e.DynamicReportingType=c[f];MsnVideoUx.launchOverlayPlayer(h,j,e,{hubDomain:c.hubdomain});c.url=i;Msn.Video.JavascriptApi.fraudDetectPing(c,"mmv","lite")}else{var g=(checkString(c[a])?c[a]:c[b])||c["mkt"];g="spawnMmv^fallback"+(checkString(g)?"^"+g:"");openStandardWindow(Msn.Video.UrlHelper.addParamValueToQuery(i,b,g,true),"_top")}}return {create:function(e){g=e;var o=new String(e.url),l=(new String(o)).split("?");if(2>l.length)throw new Error("Invalid param.url, malformed query string: "+e.url+"\nMake sure you encode urls in the query string.");var d=Msn.Video.JavascriptApi.getQSPs(l[1]);d.overlaytype=d.overlaytype||"overlayplayer";var q="vid videoid cp-documentid uuid v g".split(" ");for(var p=0;p<q.length;++p){var m=q[p];if(checkString(d[m])){d.playonloaduuid=d[m];delete d[m];break}}if(!checkDefined(d.playonloaduuid)){var i=l[0].split("/");if(checkArray(i,2)){var n=i.length,r=checkString(i[n-1])?i[n-1]:i[n-2];d.playonloadref=r}}if("multimediaviewer"==d.overlaytype)f(o,d);else if(Msn.Video.isPluginsUnsupported){var j=(checkString(d[a])?d[a]:d[b])||d["mkt"];j="spawnOverlay^fallback"+(checkString(j)?"^"+j:"");openStandardWindow(Msn.Video.UrlHelper.addParamValueToQuery(o,b,j,true),"_top")}else{if(!c)c="OverlayHolder"+Math.random();var h=document.getElementById(c);if(!checkDefined(h)){h=document.createElement("DIV");h.id=c;document.body.appendChild(h)}h.innerHTML="";d.widgetGroup=d.widgetGroup;var k={divId:c,src:"playeroverlay",widgetId:d.widgetId,flashvars:d,cachebuster:e.cachebuster||false};if(e.root)k.root=e.root;if(e.weRoot)k.weRoot=e.weRoot;Msn.Video.createWidget2(k)}return false}}}();Msn.Video.LeadWithImagePlayers={};Msn.Video.LeadWithImage=function(){var d="block",j="player",a="none",i=true,c=null,v=this,F=v,l=1024,b,f,A,w=c,q,p,y,D,s,r,m,o,u,z,g,e,n,k,h,t,x=false;v.create=function(a,d){b=a;z=d;f=a.cfgMgr;A=a.resMgr;p=b.widgetId;y=f.getValue("widgetGroup",c);n=f.getValue("leadWithImageUrl",c);if(checkString(n)){n=unescape(n);k=f.getValue("leadWithImageTitle","")}if(Msn.Video.LeadWithImagePlayers[b.divId])Msn.Video.LeadWithImagePlayers[b.divId].destroy();Msn.Video.LeadWithImagePlayers[b.divId]=F;var e=new Msn.Video.VcLoader(b);e.load(J)};v.destroy=function(){if(!x){x=i;Msn.Video.destroyWidget(b.divId);delete Msn.Video.LeadWithImagePlayers[b.divId];Msn.Video.LeadWithImagePlayers[b.divId]=c;z.innerHTML=""}};function J(S,lb,ib){var Q="playBtnDiv",C="px",y="IMG",P="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '",O="MsnVideoInitializeInternal",l="DIV";if(x)return;D=S;s=getCreateWidgetParamValue(b,"w",640);r=getCreateWidgetParamValue(b,"h",360);m=f.getValue("leadWithImageWidth",s);o=f.getValue("leadWithImageHeight",r);u=s!=m||r!=o;if(ib)k=ib;if(S){if(!checkString(n))n=H(S.uuid,m,o);if(!checkString(k))k=S.title}if(!checkString(k))k="";var L=document.createElement(l);L.className="msnLeadWithImage";z.appendChild(L);if("undefined"!=typeof MsnVideo2)B();else{q=false;w=window[O];window[O]=B}var T=Msn.Video.UrlHelper.getWERoot(b);if(u){var V=document.createElement(l);V.className="headerDiv";L.appendChild(V);g=document.createElement(l);g.className="closeBtnDiv";g.style.display=a;g.title=A.getValue(j,"clickToClose","click to close");g.onclick=F.hidePlayer;V.appendChild(g);var E=document.createElement(l);g.appendChild(E);var G=document.createElement(l);G.style.display=a;g.appendChild(G);g.onmouseover=function(){E.style.display=a;G.style.display=d};g.onmouseout=function(){G.style.display=a;E.style.display=d};var ab=T+"/i/leadWithImage/close_btn.png",X=T+"/i/leadWithImage/close_btn_hover.png",cb=Msn.Video.isIE&&checkDefined(E.style.filter);if(cb&&Msn.Video.IEVersion<7){E.style.filter=P+ab+"')";E.style.backgroundImage=a;G.style.filter=P+X+"')";G.style.backgroundImage=a}else{var db=document.createElement(y);db.src=ab;E.appendChild(db);var Z=document.createElement(y);Z.src=X;G.appendChild(Z)}}e=document.createElement(l);e.className="imageDiv";e.style.width=m+C;e.style.height=o+C;var eb=f.getValue("fontSizeOverride",c);if(checkString(eb))try{e.style.fontSize=eb}catch(kb){}e.title=k;e.onclick=I;L.appendChild(e);var U=document.createElement(l);U.className="thumbnailDiv";e.appendChild(U);if(checkString(n)){var K=document.createElement(y);K.className="thumbnail";K.src=n;K.width=m;K.height=o;U.appendChild(K)}var hb=document.createElement(l);hb.className="clear";e.appendChild(hb);var J=o*.4,t=document.createElement(l);t.className=Q;t.style.left=(m-J)/2+C;t.style.width=t.style.height=J+C;e.appendChild(t);var v=t.cloneNode(i);v.className=Q;v.style.display=a;v.style.width=v.style.height=J+C;e.appendChild(v);e.onmouseover=function(){t.style.display=a;v.style.display=d};e.onmouseout=function(){v.style.display=a;t.style.display=d};var fb="/i/leadWithImage/"+(J>70?"135x135":"70x70")+"_play_overlay",bb=T+fb+".png",Y=T+fb+"_hover.png";if(cb){var jb="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = {0}, sizingMethod='scale')";t.style.filter=format(jb,bb);t.style.backgroundImage=a;v.style.filter=format(jb,Y);v.style.backgroundImage=a}else{var R=document.createElement(y);R.src=bb;R.width=R.height=J;t.appendChild(R);var M=document.createElement(y);M.src=Y;M.width=M.height=J;v.appendChild(M)}var gb=m>600?"Wide":m<=300?"Narrow":"",N=document.createElement(l);N.className="titleBackground"+gb;N.innerHTML=k;Msn.Video.CSS.setOpacity(N,.7);e.appendChild(N);var W=document.createElement(l);W.className="title"+gb;W.innerHTML=k;e.appendChild(W);h=document.createElement(l);h.className="playerDiv";h.id=p+"PlayerDiv";h.style.display=a;h.innerHTML=j;L.appendChild(h)}function I(){var l="leadWithPlugin";if(Msn.Video.isPluginsUnsupported){var n=Msn.Video.UrlHelper.getDefaultPermalink(D,f),m=f.getValue(j,"fr",f.getValue("gallery","from",f.getValue("mkt","")));m="player^fallback"+(checkString(m)?"^"+m:"");openStandardWindow(Msn.Video.UrlHelper.addParamValueToQuery(n,"from",m,i),"_top")}else{if(h.innerHTML==j){h.innerHTML="";var k=copyFlashVars(b.flashvars,j);setParam(k,"rst","LeadWithImagePlayer");setParam(k,"fontsizeoverride",c);setIfNotSet(k,"ap","true");if(c==f.getValue(l,c)&&c==f.getValue("player.leadWithPlugin",c))setIfNotSet(k,l,"silverlight");Msn.Video.createWidget2({divId:h.id,src:b.src,w:s,h:r,flashvars:k,widgetId:p,root:b.root,weRoot:b.weRoot,vceRoot:b.vceRoot,cacheBuster:b.cacheBuster,cfgMgr:f,refMgr:A})}for(var o in Msn.Video.LeadWithImagePlayers)Msn.Video.LeadWithImagePlayers[o].hidePlayer();e.style.display=a;h.style.display=d;if(u)g.style.display=d;t=i;if(q)MsnVideo2.sendMessage({type:"playVideo",targetId:b.widgetId})}}v.hidePlayer=function(){if(t){E();e.style.display=d;h.style.display=a;if(u)g.style.display=a;t=false}};function E(){if(q)MsnVideo2.sendMessage({type:"pauseVideo",targetId:p,targetGroup:y})}function H(i,c,a){var j="";if(c>0&&a>0&&checkString(i)){if(c>l){a*=l/c;c=l}if(a>l){c*=l/a;a=l}var d=[{xr:2,yr:3},{xr:1,yr:1},{xr:4,yr:3},{xr:16,yr:9}],e=C(c,a,d[0].xr,d[0].yr);for(var g=1;g<d.length;++g){var h=C(c,a,d[g].xr,d[g].yr);if(e.maxDiff>h.maxDiff)e=h}var k=normalizeRootUrl(f.getValue("vci",Msn.Video.UrlHelper.getVCImgRoot(b)));j=format("{0}/image.aspx?uuid={1}&w={2}&h={3}&so=4",k,i,e.x,e.y)}return j}function C(f,e,c,d){var b=Math.floor(Math.min(Math.min(f,l)/c,Math.min(e,l)/d)),a={};a.scale=b;a.x=b*c;a.y=b*d;a.maxDiff=Math.max(Math.abs(f-a.x),Math.abs(e-a.y));return a}function G(b){var a=b.param.status.toLowerCase();switch(a){case "videoopening":case "videobuffering":case "videoplaying":case "adopening":case "adplaying":if(!t)E()}}function B(){MsnVideo2.addMessageReceiver({eventType:"playbackStatusChanged",widgetId:p,widgetGroup:y,funcCb:G});q=i;if("function"==typeof w)w()}};Msn.Video.LoadCSS=function LoadCSS(){Msn.Video.initializeVersionTable();if(Msn.Video.VersionTable&&Msn.Video.VersionTable.hasVersions=="true")Msn.Video.CountryCodeLoader.loadCountryCode(a);else a();function a(){var b=Msn.Video.CountryCodeLoader.getVersionPath(),a="img.widgets.video.s-msn.com";if(Msn.Video.WidgetServer&&checkString(Msn.Video.WidgetServer))a=Msn.Video.WidgetServer;Msn.Video.JavascriptApi.loadCSS(format("http://{0}/{1}{2}",a,b,"js/ch/channels.css"))}}();Msn.Video._loaded=(new Date).getTime()